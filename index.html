<!DOCTYPE html>
<html lang="it" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>17/19 Urban Bistrot</title>
  <meta name="description" content="17/19 Urban Bistrot Roma. Colazioni, pranzi, cene e cocktail. Location per eventi privati." />
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0b0b0b" media="(prefers-color-scheme: dark)">
  
  <link rel="icon" type="image/svg+xml" href="https://cdn.shopify.com/s/files/1/0887/8332/3459/files/1719logobianco.svg?v=1755104086" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet"/>

  <style>
    /* ==========================================================================
       1. ROOT & THEME VARIABLES
       ========================================================================== */
    :root {
      --header-h: 64px;
      --radius: 16px;
      --pad: clamp(16px, 4vw, 32px);
      --max: 1120px;
      --accent: #c23331;
      --accent-fg: #ffffff;
      
      /* Light Theme (Default) */
      --bg: #ffffff;
      --fg: #0b0b0b;
      --muted: #6b7280;
      --line: #e5e7eb;
      --chip: #f4f4f5;
      --chip-fg: #0b0b0b;
      
      /* Universal Dynamic Viewport Height */
      --vh: 1vh;
    }

    html[data-theme="dark"] {
      --bg: #0b0b0b;
      --fg: #ffffff;
      --muted: #9ca3af;
      --line: #1f1f1f;
      --chip: #121212;
      --chip-fg: #e5e7eb;
    }

    @media (prefers-color-scheme: dark) {
      html[data-theme="auto"] {
        --bg: #0b0b0b;
        --fg: #ffffff;
        --muted: #9ca3af;
        --line: #1f1f1f;
        --chip: #121212;
        --chip-fg: #e5e7eb;
      }
    }
    
    /* ==========================================================================
       2. GLOBAL STYLES & RESETS
       ========================================================================== */
    *, *::before, *::after { box-sizing: border-box; }

    html {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      scroll-behavior: smooth;
      scrollbar-gutter: stable both-edges;
    }
    
    html, body {
      margin: 0;
      padding: 0;
      max-width: 100%;
      overflow-x: hidden;
    }
    
    body {
      background: var(--bg);
      color: var(--fg);
      font-family: 'Inter', system-ui, sans-serif;
      line-height: 1.6;
    }

    body.menu-open, body.modal-open { overflow: hidden; }
    
    img { max-width: 100%; display: block; }
    
    /* ==========================================================================
       3. LAYOUT & GRID
       ========================================================================== */
    .container { max-width: var(--max); margin-inline: auto; padding-inline: var(--pad); }
    section { padding: 20px 0; }
    
    .grid { display: grid; gap: 16px; }
    .grid-2 { grid-template-columns: 1fr; }
    .grid-3 { grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    
    .only-desktop { display: none; }
    .only-mobile { display: inline-flex; }
    
    @media (min-width: 768px) {
      .grid-2 { grid-template-columns: 1.2fr 0.8fr; }
      .only-desktop { display: inline-flex; }
      .only-mobile { display: none; }
    }

    /* ==========================================================================
       4. COMPONENTS
       ========================================================================== */
    
    /* --- Header --- */
    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      background: transparent;
      border-bottom: 0;
      z-index: 100;
      transition: background 0.2s ease, border-color 0.2s ease;
    }
    header.header--solid {
      background: color-mix(in oklab, var(--bg) 85%, transparent);
      border-bottom: 1px solid var(--line);
      backdrop-filter: saturate(140%) blur(8px);
    }
    nav { display: flex; align-items: center; justify-content: space-between; height: var(--header-h); }
    .brand { display: flex; align-items: center; gap: 12px; text-decoration: none; color: inherit; }
    .brand img { height: 48px; width: auto; }
    .logo-dark { display: none; } .logo-light { display: inline; }
    html[data-theme="dark"] .logo-light, @media (prefers-color-scheme: dark) { html[data-theme="auto"] .logo-light { display: none; } }
    html[data-theme="dark"] .logo-dark, @media (prefers-color-scheme: dark) { html[data-theme="auto"] .logo-dark { display: inline; } }

    .nav-desktop { display: none; gap: 12px; align-items: center; list-style: none; margin: 0; padding: 0; }
    @media (min-width: 768px) { .nav-desktop { display: flex; } }
    .nav-desktop a { color: var(--fg); text-decoration: none; font-weight: 700; opacity: 0.86; transition: opacity 0.2s; }
    .nav-desktop a:hover { opacity: 1; }

    /* --- Pills & Buttons --- */
    .pill {
      display: inline-flex; align-items: center; gap: 0.55rem;
      padding: 0.55rem 0.9rem;
      border: 1px solid var(--line);
      border-radius: 999px;
      text-decoration: none; font-weight: 800;
      background: var(--chip); color: var(--chip-fg);
      transition: transform 0.15s ease;
    }
    .pill--accent { background: var(--accent); border-color: var(--accent); color: var(--accent-fg); }
    .pill--ghost { background: transparent; }
    .pill--disabled { opacity: 0.55; pointer-events: none; }
    .pill:where(:hover, :focus-visible) { transform: translateY(-1px); }
    .pill--wide { padding: 0.66rem 1rem; font-weight: 900; }

    .toggle, .menu-toggle {
      width: 44px; height: 44px;
      border: 1px solid var(--line);
      border-radius: 12px;
      background: var(--chip);
      color: var(--chip-fg);
      display: grid;
      place-items: center;
      cursor: pointer;
    }
    .menu-toggle span, .menu-toggle span::before, .menu-toggle span::after {
      display: block; width: 18px; height: 2px;
      background: var(--fg); content: ""; position: relative;
    }
    .menu-toggle span::before { position: absolute; top: -6px; }
    .menu-toggle span::after { position: absolute; top: 6px; }

    /* --- Fullscreen Menu (Sheet) --- */
    .sheet {
      position: fixed; inset: 0;
      background: rgba(0, 0, 0, 0.68);
      opacity: 0; pointer-events: none;
      z-index: 999;
      transition: opacity 0.25s ease;
      backdrop-filter: blur(18px) saturate(120%);
      color: #fff;
    }
    .sheet.active { opacity: 1; pointer-events: auto; }
    .sheet__panel { position: absolute; inset: 0; display: grid; grid-template-rows: auto 1fr; align-items: start; }
    .sheet__close {
      position: absolute; top: 14px; right: 14px;
      width: 44px; height: 44px;
      border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.25);
      background: rgba(255, 255, 255, 0.10);
      color: #fff; font-size: 24px; font-weight: 900;
      display: grid; place-items: center; cursor: pointer; z-index: 1000;
    }
    .sheet__inner {
      display: grid; place-items: center; height: 100%; padding: 28px;
      opacity: 0; transform: translateY(6px) scale(0.99); overflow: auto;
      transition: opacity 0.25s ease 0.06s, transform 0.25s ease 0.06s;
    }
    .sheet.active .sheet__inner { opacity: 1; transform: none; }
    .sheet__list { list-style: none; margin: 0; padding: 0; display: grid; gap: 14px; text-align: center; }
    .sheet__list a {
      display: block; padding: 10px 14px; border-radius: 14px;
      text-decoration: none; color: #fff; font-weight: 900;
      font-size: clamp(1.4rem, 5vw, 2.4rem); letter-spacing: 0.04em;
    }
    .sheet__list a:hover { background: rgba(255, 255, 255, 0.08); }
    .sheet__cta { display: inline-flex; margin-top: 18px; }
    .sheet.active .sheet__list a { animation: menuStagger 0.28s ease both; }
    .sheet.active .sheet__list li:nth-child(1) a { animation-delay: 0.05s; }
    .sheet.active .sheet__list li:nth-child(2) a { animation-delay: 0.09s; }
    .sheet.active .sheet__list li:nth-child(3) a { animation-delay: 0.13s; }
    .sheet.active .sheet__list li:nth-child(4) a { animation-delay: 0.17s; }
    .sheet.active .sheet__list li:nth-child(5) a { animation-delay: 0.21s; }
    @keyframes menuStagger { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }
    
    /* --- Hero Section --- */
    .hero { padding: calc(var(--header-h) + 12px) 0 24px; }
    .tag { display: inline-flex; gap: 8px; align-items: center; border: 1px solid var(--line); border-radius: 999px; padding: 6px 10px; font-weight: 800; color: var(--chip-fg); max-width: 100%; white-space: normal; overflow-wrap: anywhere; }
    h1 { font-family: 'Montserrat', system-ui, sans-serif; font-weight: 900; text-transform: uppercase; letter-spacing: 0.01em; font-size: clamp(2.1rem, 8vw, 3.6rem); line-height: 1.1; margin: 12px 0 10px; }
    .lead { color: var(--fg); font-size: clamp(1rem, 4.5vw, 1.18rem); margin: 8px 0 14px; }
    
    /* Hero Carousel (Live Shots) */
    .hero-media { position: relative; border: 1px solid var(--line); border-radius: 16px; overflow: hidden; background: var(--chip); margin-top: 14px; aspect-ratio: 4 / 5; }
    @media (min-width: 768px) { .hero-media { aspect-ratio: 16 / 9; margin-top: 18px; } }
    .hero-media .slide { position: absolute; inset: 0; opacity: 0; transform: scale(1.01); transition: opacity 0.4s ease, transform 0.4s ease; will-change: opacity, transform; backface-visibility: hidden; }
    .hero-media .slide.active { opacity: 1; transform: scale(1); }
    .hero-media .dots { position: absolute; left: 0; right: 0; bottom: 10px; display: flex; gap: 6px; justify-content: center; z-index: 2; }
    .hero-media .dot { width: 8px; height: 8px; border-radius: 50%; background: color-mix(in oklab, var(--fg) 24%, transparent); border: 0; cursor: pointer; }
    .hero-media .dot.active { background: var(--fg); }

    /* Hero Poster Frame */
    .poster-frame { position: relative; border: 1px solid var(--line); border-radius: 20px; background: var(--bg); overflow: hidden; margin-bottom: 12px; }
    .poster-inner { position: relative; padding: clamp(18px, 4vw, 28px); }
    .poster-head { display: flex; flex-direction: column; align-items: center; text-align: center; gap: 6px; user-select: none; }
    .poster-head .venue { font-weight: 900; letter-spacing: 0.10em; text-transform: uppercase; font-size: clamp(0.9rem, 1.8vw, 1rem); }
    .poster-head .series { font-family: 'Montserrat', system-ui, sans-serif; font-weight: 900; letter-spacing: 0.06em; text-transform: uppercase; font-size: clamp(2rem, 6.5vw, 3.1rem); line-height: 1.05; }
    .poster-head .date { font-weight: 900; letter-spacing: 0.10em; text-transform: uppercase; font-size: clamp(0.95rem, 3.5vw, 1.2rem); }
    .poster-canvas { position: relative; margin-top: clamp(16px, 3.2vw, 26px); height: min(58dvh, 120vw, 560px); background: color-mix(in oklab, var(--chip) 94%, transparent); border: 1px solid var(--line); border-radius: 14px; overflow: hidden; }
    .poster-canvas canvas.trail { position: absolute; inset: 0; pointer-events: none; z-index: 1; }
    .poster-logos { position: relative; padding: 10px 10px 0; display: flex; gap: 12px; justify-content: center; align-items: center; flex-wrap: wrap; row-gap: 6px; user-select: none; }
    .poster-logos span.poster-sponsor { font-weight: 900; letter-spacing: 0.12em; font-size: 0.72rem; opacity: 0.95; }
    
    .bouncer { position: absolute; display: inline-flex; align-items: center; gap: 10px; padding: 0.16em 0.44em; border-radius: 6px; font-weight: 900; letter-spacing: 0.06em; text-transform: uppercase; white-space: nowrap; will-change: transform; box-shadow: 0 0 0 1px var(--line) inset; background: color-mix(in oklab, var(--bg) 96%, transparent); user-select: none; touch-action: manipulation; z-index: 2; }
    .bouncer .dot { display: inline-block; width: 6px; height: 6px; border-radius: 2px; background: var(--fg); margin-right: 2px; vertical-align: middle; }
    .bouncer .rc { display: none !important; align-items: center; gap: 6px; padding: 0.1rem 0.4rem; border-radius: 999px; border: 1px solid var(--line); background: color-mix(in oklab, var(--bg) 96%, transparent); font-weight: 900; }
    .bouncer .lbl { transition: color 0.2s; }
    .bouncer.up-lit .lbl { color: var(--accent); text-shadow: 0 0 10px color-mix(in oklab, var(--accent) 40%, transparent); }

    /* --- General Cards & Blocks --- */
    .card { border: 1px solid var(--line); border-radius: 16px; padding: 16px; background: color-mix(in oklab, var(--bg) 96%, transparent); }
    .block-title { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
    .block-title h3 { font-family: 'Montserrat', system-ui, sans-serif; font-size: 1rem; margin: 0; letter-spacing: 0.02em; }
    .meta { color: var(--muted); font-size: 0.95rem; }
    .hero-right { display: grid; gap: 12px; }

    .time-cards { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 6px; }
    @media (max-width: 420px) { .time-cards { grid-template-columns: 1fr; } }
    .time-card { display: flex; align-items: center; justify-content: space-between; gap: 10px; border: 1px solid var(--line); border-radius: 14px; padding: 10px 12px; background: color-mix(in oklab, var(--bg) 98%, transparent); }
    .time-card .l { display: flex; align-items: center; gap: 8px; }
    .time-card .i { display: grid; place-items: center; width: 28px; height: 28px; border-radius: 10px; background: var(--chip); border: 1px solid var(--line); }

    /* --- Menu Accordion --- */
    #menuAccordions { grid-template-columns: 1fr; }
    @media (min-width: 980px) { #menuAccordions { grid-template-columns: 1fr 1fr; } }
    .badge { display: inline-block; background: var(--accent); color: var(--accent-fg); padding: 6px 10px; border-radius: 999px; font-size: 0.75rem; font-weight: 900; }
    details.menu-acc { border: 1px solid var(--line); border-radius: 16px; background: color-mix(in oklab, var(--bg) 96%, transparent); padding: 12px; }
    details.menu-acc + details.menu-acc { margin-top: 12px; }
    details.menu-acc[open] { background: color-mix(in oklab, var(--bg) 98%, transparent); }
    summary.menu-sum { list-style: none; display: flex; align-items: center; gap: 10px; cursor: pointer; }
    summary.menu-sum::-webkit-details-marker { display: none; }
    .menu-sum h3 { margin: 8px 0 0; font-family: 'Montserrat', system-ui, sans-serif; }
    .menu-sum .chev { margin-left: auto; transition: transform 0.2s; }
    details[open] .menu-sum .chev { transform: rotate(180deg); }
    .menu-body { padding: 8px 4px 2px; max-height: 0; overflow: hidden; transition: max-height 0.25s ease-out; }
    details[open] > .menu-body { max-height: 2000px; /* Arbitrary large value */ }
    .group-title { margin: 8px 0 4px; font-weight: 800; }
    .menu-item { display: flex; justify-content: space-between; gap: 10px; padding: 10px 0; border-bottom: 1px dashed var(--line); }
    .menu-item .mi-right { display: flex; flex-direction: column; align-items: flex-end; gap: 6px; }
    .menu-item:last-child { border-bottom: 0; }
    .price { color: var(--accent); font-weight: 800; }

    /* --- Events --- */
    .event { position: relative; display: grid; gap: 10px; align-items: start; border: 1px solid var(--line); border-radius: 16px; padding: 14px; background: color-mix(in oklab, var(--bg) 96%, transparent); transition: box-shadow 0.2s, transform 0.2s, border-color 0.2s; touch-action: manipulation; user-select: none; }
    .event__title { font-weight: 900; }
    .event__top { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .event__date { min-width: 66px; text-align: center; border: 1px solid var(--line); border-radius: 12px; padding: 8px 10px; background: var(--chip); }
    .event__dow { font-weight: 900; } .event__day { font-size: 1.4rem; font-weight: 900; line-height: 1; }
    .event__info { display: flex; flex-wrap: wrap; gap: 8px; color: var(--muted); font-size: 0.95rem; }
    .event__names { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 4px; }
    .event__actions { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
    .events-more { display: flex; justify-content: center; margin-top: 10px; }
    .event--voted { border-color: color-mix(in oklab, var(--accent) 65%, transparent); box-shadow: 0 0 0 1px color-mix(in oklab, var(--accent) 35%, transparent) inset, 0 6px 18px rgba(255, 31, 61, 0.22); }
    .event--burst { animation: cardPopShake 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); }
    @keyframes cardPopShake { 0% { transform: scale(1) translateX(0) rotate(0); } 12% { transform: scale(1.03) translateX(-1.5px) rotate(-0.3deg); } 24% { transform: scale(1.03) translateX(1.5px) rotate(0.3deg); } 36% { transform: scale(1.02) translateX(-1px) rotate(-0.2deg); } 48% { transform: scale(1.02) translateX(1px) rotate(0.2deg); } 60% { transform: scale(1.01) translateX(0.5px) rotate(0); } 100% { transform: scale(1) translateX(0) rotate(0); } }
    .vote-badge { position: absolute; top: 8px; right: 8px; font-weight: 900; background: color-mix(in oklab, var(--bg) 92%, transparent); border: 1px solid var(--line); border-radius: 999px; padding: 4px 8px; font-size: 0.9rem; display: inline-flex; align-items: center; gap: 6px; }
    .share-pop { position: absolute; z-index: 50; background: color-mix(in oklab, var(--bg) 96%, transparent); border: 1px solid var(--line); border-radius: 10px; padding: 8px; display: none; gap: 6px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .share-pop button, .share-pop a { border: 1px solid var(--line); background: var(--chip); color: var(--chip-fg); border-radius: 8px; padding: 6px 8px; text-decoration: none; font-weight: 800; font-size: 0.9rem; }
    .name-chip { display: inline-flex; align-items: center; gap: 6px; padding: 0.18rem 0.46rem; border: 1px dashed var(--line); border-radius: 12px; font-weight: 800; letter-spacing: 0.04em; background: color-mix(in oklab, var(--bg) 98%, transparent); }

    /* --- Private Events Section --- */
    .private-events { background: color-mix(in oklab, var(--accent) 5%, transparent); border: 1px solid color-mix(in oklab, var(--accent) 20%, transparent); border-radius: 16px; padding: 20px; margin-top: 16px; }
    .private-events h4 { margin: 0 0 12px; font-family: 'Montserrat', system-ui, sans-serif; font-weight: 900; color: var(--accent); }
    .private-events-grid { display: grid; gap: 8px; margin: 12px 0; }
    .private-events-grid span { display: flex; align-items: center; gap: 8px; font-weight: 600; }

    /* --- Map --- */
    .map { border: 1px solid var(--line); border-radius: 16px; overflow: hidden; }
    .map iframe { width: 100%; height: 320px; border: 0; display: block; }
    @media (min-width: 768px) { .map iframe { height: 360px; } }

    /* --- Footer & FAB --- */
    footer { border-top: 1px solid var(--line); padding: 28px 0; color: var(--muted); text-align: center; }
    .fab { position: fixed; right: 16px; bottom: 16px; width: 56px; height: 56px; border-radius: 999px; background: var(--accent); display: grid; place-items: center; box-shadow: 0 10px 22px rgba(0, 0, 0, 0.15); text-decoration: none; z-index: 80; }
    .fab svg { width: 26px; height: 26px; }
    .fab path { fill: var(--accent-fg); }

    /* --- Modal --- */
    .modal {
      position: fixed; inset: 0;
      display: grid; place-items: center;
      background: rgba(0, 0, 0, 0.65);
      z-index: 1200;
      opacity: 0; visibility: hidden;
      transition: opacity 0.2s ease, visibility 0s 0.2s;
      will-change: opacity;
    }
    .modal.show {
      opacity: 1; visibility: visible;
      transition: opacity 0.2s ease;
    }
    .modal__body {
      position: relative;
      background: var(--bg);
      border: 1px solid var(--line);
      border-radius: 16px;
      max-width: min(920px, 96vw);
      max-height: 90vh;
      padding: 10px;
      transform: scale(0.95);
      transition: transform 0.2s ease;
      will-change: transform;
    }
    .modal.show .modal__body {
        transform: scale(1);
    }
    .modal__body img { display: block; max-width: 100%; max-height: 80vh; border-radius: 12px; }
    .modal__close { position: absolute; right: -15px; top: -15px; width: 40px; height: 40px; border-radius: 999px; border: 1px solid var(--line); background: var(--bg); color: var(--fg); font-size: 22px; font-weight: 900; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .modal__caption { margin-top: 6px; text-align: center; }
    
    .photo-btn {
      display: inline-flex; align-items: center; gap: 6px;
      border: 1px solid var(--line); background: var(--chip); color: var(--chip-fg);
      border-radius: 999px; padding: 3px 8px;
      font-weight: 800; font-size: 0.8rem;
      margin-left: 8px; cursor: pointer;
    }
    .photo-btn svg { width: 14px; height: 14px; }
    
    /* --- Utilities --- */
    .reveal { opacity: 0; transform: translateY(16px); transition: opacity 0.5s ease, transform 0.5s ease; }
    .reveal.active { opacity: 1; transform: translateY(0); }
    
    .loader-overlay { position: absolute; inset: 0; display: grid; place-items: center; pointer-events: none; background: rgba(0,0,0,0.1); opacity: 1; transition: opacity 0.18s ease; }
    .loader-overlay.hidden { opacity: 0; }
    .loader--ring { --s: 22px; --w: 3px; width: var(--s); height: var(--s); border-radius: 50%; display: inline-block; border: var(--w) solid color-mix(in oklab, var(--accent) 26%, transparent); border-top-color: var(--accent); animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    .icon { width: 16px; height: 16px; display: inline-block; vertical-align: middle; }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 1ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 1ms !important;
        scroll-behavior: auto !important;
      }
    }
    
    /* --- Hero Responsive Fixes --- */
    @media (max-width: 430px) {
      .poster-canvas { height: min(58dvh, 120vw, 560px); }
      .hero-media { aspect-ratio: 3 / 4; }
    }
    @media (max-width: 360px) {
      h1 { font-size: clamp(1.9rem, 7.5vw, 2.6rem); }
      .poster-head .series { font-size: clamp(1.6rem, 9vw, 2.4rem); }
    }
    @media (min-width: 431px) and (max-width: 480px) {
      .poster-canvas { height: min(64dvh, 110vw, 600px); }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <nav aria-label="principale">
        <a class="brand" href="#">
          <img class="logo-light" src="https://cdn.shopify.com/s/files/1/0887/8332/3459/files/1719logooo.svg?v=1755102480" alt="17/19 Urban Bistrot - Logo"/>
          <img class="logo-dark"  src="https://cdn.shopify.com/s/files/1/0887/8332/3459/files/1719logobianco.svg?v=1755104086" alt="17/19 Urban Bistrot - Logo (dark)"/>
        </a>

        <ul class="nav-desktop">
          <li><a href="#about">About</a></li>
          <li><a href="#menu">Menu</a></li>
          <li><a href="#events">Eventi</a></li>
          <li><a href="#contact">Contatti</a></li>
          <li><a href="#private">Eventi Privati</a></li>
          <li><a class="pill pill--accent" href="#menu">Menù</a></li>
          <li><a class="pill pill--accent" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot%2C%20vorrei%20prenotare" target="_blank" rel="noopener">Prenota</a></li>
          <li><button id="themeToggle" class="toggle" aria-label="Tema: automatico"></button></li>
          <li><button class="menu-toggle" id="menuToggleD" aria-label="Apri/chiudi menu"><span></span></button></li>
        </ul>

        <div class="only-mobile" style="gap:8px;align-items:center">
          <a href="#menu" class="pill pill--accent pill--wide" aria-label="Vai al menù">Menù</a>
          <button id="themeToggleM" class="toggle" aria-label="Tema: automatico"></button>
          <button class="menu-toggle" id="menuToggle" aria-label="Apri/chiudi menu"><span></span></button>
        </div>
      </nav>
    </div>
  </header>

  <div class="sheet" id="siteMenu" role="dialog" aria-hidden="true" aria-modal="true" aria-labelledby="menu-heading">
    <div class="sheet__panel">
      <h2 id="menu-heading" class="visually-hidden">Menu Principale</h2>
      <button class="sheet__close" id="sheetClose" type="button" aria-label="Chiudi menu">×</button>
      <div class="sheet__inner">
        <ul class="sheet__list">
          <li><a href="#about">About</a></li>
          <li><a href="#menu">Menu</a></li>
          <li><a href="#events">Eventi</a></li>
          <li><a href="#private">Eventi Privati</a></li>
          <li><a href="#contact">Contatti</a></li>
        </ul>
        <a class="pill pill--accent sheet__cta" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot%2C%20vorrei%20prenotare" target="_blank" rel="noopener">Prenota</a>
      </div>
    </div>
  </div>

  <section class="hero">
    <div class="container grid grid-2">
      <div class="reveal">
        <div class="poster-frame" id="posterFrame" style="display: none;">
          <div class="poster-inner">
            <div class="poster-head">
              <div class="venue" id="posterVenue"></div>
              <div class="series" id="posterSeries"></div>
              <div class="date" id="posterDate"></div>
            </div>
            <div class="poster-canvas" id="posterCanvas" aria-label="bouncer nomi"></div>
            <div class="poster-logos" id="posterLogos" aria-hidden="true"></div>
          </div>
        </div>
        <div class="hero-media" id="liveCarousel" aria-label="live shots"><div class="dots" id="liveDots"></div></div>
        <span class="tag" style="margin-top:12px">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px">
            <path d="M12 22s7-5.33 7-12a7 7 0 1 0-14 0c0 6.67 7 12 7 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
          </svg>
          Roma • Via di Santa Costanza 17/19
        </span>
      </div>

      <div class="hero-right">
        <aside class="card reveal" aria-label="Orari e Servizio">
          <div class="block-title"><h3>Orari & Apertura</h3><span class="meta">Servizio</span></div>
          <div class="time-cards">
            <div class="time-card"><div class="l"><span class="i" aria-hidden="true"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M17 8h1a4 4 0 0 1 0 8h-1"/><path d="M3 8h14v6a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><path d="M6 2v4M10 2v4M14 2v4"/></svg></span><strong>Colazioni</strong></div><strong>08:00–12:00</strong></div>
            <div class="time-card"><div class="l"><span class="i" aria-hidden="true"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M4 3v7a2 2 0 0 0 2 2v9"/><path d="M8 3v7a2 2 0 0 1-2 2"/><path d="M12 3v18"/><path d="M15.5 3.5c2 2 2 6.5 0 8.5L12 12"/></svg></span><strong>Pranzo</strong></div><strong>12:00–15:00</strong></div>
            <div class="time-card"><div class="l"><span class="i" aria-hidden="true"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"><path d="M12 7a6 6 0 0 0-6 6h12a6 6 0 0 0-6-6Z"/><path d="M12 5v2"/><path d="M4 19h16"/></svg></span><strong>Cena</strong></div><strong>19:00–23:00</strong></div>
            <div class="time-card"><div class="l"><span class="i" aria-hidden="true"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="2"/><path d="M14 10h.01"/><path d="M10 14h.01"/></svg></span><strong>DJ Set/Dopocena</strong></div><strong>21:00-01:00</strong></div>
          </div>
        </aside>

        <div id="about" class="card reveal">
          <div class="block-title"><h3>Urban Bistrot</h3></div>
          <p style="margin:0">17/19 è un bar con cucina contemporanea: si pranza e si cena, si passa per un caffè, si resta per cocktail, aperitivo e dopocena. Facciamo anche eventi con musica dal vivo — line-up curata dai nostri <strong>resident DJ</strong>. Spazio polifunzionale aperto a tutti.</p>
        </div>
      </div>
    </div>
  </section>

  <section id="menu">
    <div class="container">
      <div class="block-title" style="margin-bottom:6px"><h3>Il nostro menù</h3></div>
      <div id="menuAccordions" class="grid" style="gap:12px"></div>
    </div>
  </section>

  <section id="private">
    <div class="container">
      <div class="card reveal">
        <div class="block-title"><h3>Eventi Privati</h3><span class="meta">Location esclusiva</span></div>
        <p>17/19 Urban Bistrot è la location perfetta per i tuoi eventi privati. Organizziamo con cura ogni dettaglio per rendere speciale la tua occasione.</p>
        <div class="private-events">
          <h4>Che tipo di eventi organizziamo:</h4>
          <div class="private-events-grid">
            <span>🎂 Compleanni e feste private</span>
            <span>🎓 Feste di laurea</span>
            <span>🍽️ Cene di gruppo e aziendali</span>
            <span>🎉 Aperitivi e cocktail party</span>
            <span>🎵 Eventi con DJ set personalizzati</span>
          </div>
          <p style="margin:12px 0 16px;font-size:.95rem;color:var(--muted)">Spazio dedicato al piano superiore, servizio alla carta o catering, impianto audio e atmosfera unica nel cuore di Roma.</p>
          <a class="pill pill--accent" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot%2C%20vorrei%20organizzare%20un%20evento%20privato" target="_blank" rel="noopener">Richiedi Preventivo</a>
        </div>
      </div>
    </div>
  </section>

  <section id="events">
    <div class="container">
      <div class="block-title" style="margin-bottom:6px"><h3>Prossimi Eventi</h3></div>
      <div class="grid" id="eventsList" style="gap:12px"></div>
      <div class="events-more">
        <button id="eventsMoreBtn" class="pill pill--ghost" type="button">Mostra altri</button>
      </div>
    </div>
  </section>

  <section id="contact">
    <div class="container grid grid-2">
      <div class="card reveal">
        <div class="block-title"><h3>Contatti</h3></div>
        <p><strong>Indirizzo</strong><br/>Via di Santa Costanza 17/19 – 00198 Roma</p>
        <p><strong>Prenotazioni</strong><br/>WhatsApp: <a class="pill" href="https://wa.me/393298252092" target="_blank" rel="noopener">+39 329 825 2092</a><br/><br/>Email: <a class="pill" href="mailto:info@1719bistrot.it">info@1719bistrot.it</a></p>
        <p><strong>Social</strong><br/><a class="pill" href="https://instagram.com/1719_cocktailbar" target="_blank" rel="noopener">Instagram</a> <a class="pill" href="https://www.facebook.com/p/1719-Cocktail-Bar-Bistrot-100077668764198/" target="_blank" rel="noopener">Facebook</a></p>
      </div>
      <div class="card reveal">
        <div class="block-title"><h3>Dove siamo</h3><a class="pill pill--accent" href="https://maps.app.goo.gl/wJb7V7fXk7eXkZzZA" target="_blank" rel="noopener">Apri su Google Maps</a></div>
        <div class="map">
          <iframe title="Mappa 17/19 Urban Bistrot" loading="lazy" referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2969.349001358355!2d12.511116715442124!3d41.90695497922002!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x132f61642877a3c9%3A0x2a14bce9b8a8b1a3!2sVia%20di%20Santa%20Costanza%2C%2017%2F19%2C%2000198%20Roma%20RM!5e0!3m2!1sen!2sit!4v1672532474253!5m2!1sen!2sit"></iframe>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container"><p>© 2025 17/19 Urban Bistrot Roma</p></div>
  </footer>

  <a class="fab" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot" target="_blank" rel="noopener" aria-label="Contattaci su WhatsApp">
    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 1.5c5.8 0 10.5 4.7 10.5 10.5S17.8 22.5 12 22.5A10.5 10.5 0 0 1 6.99 21.23L3 21l.82-3.89A10.45 10.45 0 0 1 1.5 12C1.5 6.2 6.2 1.5 12 1.5Z" fill="currentColor" opacity=".96"/><path d="M16.63 14.62c-.19-.1-1.13-.6-1.3-.66-.17-.06-.29-.1-.42.1s-.49.66-.6.8c-.11.13-.22.15-.41.06-.19-.1-.81-.3-1.55-.98-.57-.51-.95-1.13-1.06-1.31-.11-.19-.01-.29.09-.39.09-.09.2-.24.29-.36.1-.12.13-.2.19-.33.06-.13.03-.25-.02-.35-.05-.1-.44-1.05-.6-1.45-.16-.39-.33-.33-.45-.34h-.38c-.13 0-.33.05-.5.24-.17.19-.66.65-.66 1.59 0 .94.68 1.85.78 2 .1.13 1.31 2.07 3.2 2.91.45.2.8.32 1.04.41.44.15.85.13 1.17.08.36-.05 1.1-.45 1.25-.89.15-.44.15-.82.11-.91-.05-.08-.16-.13-.41-.25Z" fill="#fff"/></svg>
  </a>

  <div class="modal" id="photoModal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="modalCaption">
    <div class="modal__body">
      <button class="modal__close" type="button" aria-label="Chiudi">×</button>
      <img id="modalPhoto" alt="Foto prodotto">
      <div id="modalCaption" class="modal__caption meta"></div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {

      /* ==========================================================================
         CONFIG & DATA
         ========================================================================== */
      const CONFIG = {
        SHOW_POSTER: false, // true to show the poster, false to show the live shots carousel
        KEY: 'eventreactions1719',
        PERSIST_REMOTE: {
          enabled: true,
          endpoint: 'https://script.google.com/macros/s/AKfycbyukoQfi8AKrj0dtGGU4gRCCjWMA8Aik1E1s1ssTmWazIEGk0yJjdavqsWd4LE0_Z4/exec?key=eventreactions1719'
        }
      };

      const liveImages = [
        '/media/carosello1.webp',
        '/media/carosello2.webp',
        '/media/carosello3.webp',
        '/media/carosello4.webp',
      ];

      const menuData = [
        { 
          badge:'BREAKFAST', title:'Colazione',
          groups:[
            { title:'Colazioni Special', items:[
              { name:"Colazione all'Italiana", desc:"Tris di mieli, frutta fresca, latticino, pan dolce/integrale, frutta secca, latte aromatizzato e caffè", price:"€10,00" },
              { name:"French Breakfast", desc:"Tè o infuso, pan piastrato/brioche con burro, selezione di marmellate", price:"€7,00" },
              { name:"American Breakfast Salata", desc:"Bacon, uova strapazzate, pan piastrato, burro e confetture, caffè americano", price:"€12,00" },
            ]},
            { title:'Bakery', items:[
              { name:"Pancake con sciroppo d'acero o d'agave", price:"€4,00" },
              { name:"Pancake con crema, cioccolata o pistacchio e panna", price:"€5,00" },
              { name:"Croissant mignon semplice o farcito", price:"€1,50" },
            ]},
          ]
        },
        { 
          badge:'GASTRONOMY', title:'Gastronomia',
          groups:[
            { title:'Club Sandwiches', items:[
              { "name": "ClubSandwich + Patate", "desc": "Scegli il tuo gusto preferito, servito con chips di nostra produzione e salse", "price": "€12,00", "photo":"/media/Clubsandwichpatate.webp" },
              { "name": "Classic Club", "desc": "Prosciutto, formaggio, insalata, pomodoro e pancetta", "price": "€8,00", "photo":"/media/Club%20Sandwich%20Cotto.webp" },
              { "name": "Tonno Club", "desc": "Insalata di tonno, radicchio, uovo sodo, salsa tartara, insalata e pomodoro", "price": "€8,00", "photo":"/media/Club%20Sandwich%20tonno.webp" },
              { "name": "Salmone Club", "desc": "Salmone affumicato, Philadelphia, uovo sodo, insalata e pomodoro", "price": "€9,00", "photo":"/media/Club%20Sandwich%20salmone.webp" },
            ]},
            { title:'Primi Piatti', items:[
              { "name": "Lasagna alla Bolognese", "price": "€10" },
              { "name": "Parmigiana di Melanzane", "price": "€10" },
              { "name": "Ravioloni Pistacchio e Ragù Bianco", "price": "€13" },
            ]},
          ]
        },
        { 
          badge:'DRINKS', title:'Drinks', 
          items:[
            { name:'— In allestimento —', desc:'', price:'' , photo: null}
          ]
        }
      ];

      const events = [
        { dateISO: '2025-10-02', booking:'soon', venue: '17/19 URBAN BISTROT', title: 'Techno Resonance', genres: ['Techno', 'Deep House'], start: '22:00', headliner: 'DJ Vortex', guests: ['Synth Echo'], sponsors: [{text:'Red Bull'}] },
        { dateISO: '2025-10-03', booking:'open', venue: '17/19 URBAN BISTROT', title: 'Vinyl Grooves', genres: ['Funk', 'Soul'], start: '21:30', headliner: 'Groovemaster Flash', guests: [], sponsors: [] },
        { dateISO: '2025-10-04', booking:'open', venue: '17/19 URBAN BISTROT', title: 'Electro Swing Night', genres: ['Electro Swing'], start: '22:00', headliner: 'Lady Jitterbug', guests: ['The Swingbots'], sponsors: [{text:'Aperol'}] },
        { dateISO: '2025-10-10', booking:'soon', venue: '17/19 URBAN BISTROT', title: 'Deep Melodies', genres: ['Melodic Techno'], start: '23:00', headliner: 'Aura', guests: ['Drift'], sponsors: [] },
      ];

      /* ==========================================================================
         UTILS & HELPERS
         ========================================================================== */
      const $ = (s, r = document) => r.querySelector(s);
      const $$ = (s, r = document) => Array.from(r.querySelectorAll(s));
      const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
      const slug = s => String(s || '').toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9\-]/g, '');

      /* ==========================================================================
         UI COMPONENTS & LOGIC
         ========================================================================== */

      // --- Dynamic Viewport Height ---
      function setVH() {
        document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
      }
      setVH();
      window.addEventListener('resize', setVH, { passive: true });

      // --- Header Transparency on Scroll ---
      const header = $('header');
      const onScroll = () => { header.classList.toggle('header--solid', window.scrollY > 8); };
      window.addEventListener('scroll', onScroll, { passive: true });
      onScroll();

      // --- Fullscreen Menu ---
      const siteMenu = $('#siteMenu');
      const openMenu = () => { siteMenu.classList.add('active'); siteMenu.setAttribute('aria-hidden', 'false'); document.body.classList.add('menu-open'); };
      const closeMenu = () => { siteMenu.classList.remove('active'); siteMenu.setAttribute('aria-hidden', 'true'); document.body.classList.remove('menu-open'); };
      $$('#menuToggle, #menuToggleD').forEach(btn => btn.addEventListener('click', openMenu));
      $('#sheetClose').addEventListener('click', closeMenu);
      siteMenu.addEventListener('click', (e) => { if (e.target === siteMenu) closeMenu(); });
      $$('#siteMenu a').forEach(a => a.addEventListener('click', () => setTimeout(closeMenu, 80)));
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });
      
      // --- Theme Toggler ---
      const THEME_KEY = 'theme-1719';
      const root = document.documentElement;
      function applyTheme(mode) {
        root.setAttribute('data-theme', mode);
        localStorage.setItem(THEME_KEY, mode);
        const icon = mode === 'auto' ? `<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><circle cx="12" cy="12" r="5" fill="currentColor"/><text x="12" y="22" text-anchor="middle" font-size="7" fill="currentColor">AUTO</text></svg>`
                     : mode === 'light' ? `<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2m0 16v2M2 12h2m16 0h2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4"/></svg>`
                     : `<svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>`;
        $$('#themeToggle, #themeToggleM').forEach(btn => btn.innerHTML = icon);
      }
      function cycleTheme() {
        const cur = root.getAttribute('data-theme') || 'auto';
        const next = cur === 'auto' ? 'light' : cur === 'light' ? 'dark' : 'auto';
        applyTheme(next);
      }
      $$('#themeToggle, #themeToggleM').forEach(btn => btn.addEventListener('click', cycleTheme));
      applyTheme(localStorage.getItem(THEME_KEY) || 'auto');

      // --- Smooth Scroll with Header Offset ---
      $$('a[href^="#"]').forEach(a => {
        a.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          const targetEl = $(href);
          if (targetEl) {
            e.preventDefault();
            const headerH = parseInt(getComputedStyle(root).getPropertyValue('--header-h')) || 64;
            const y = targetEl.getBoundingClientRect().top + window.scrollY - (headerH + 8);
            window.scrollTo({ top: y, behavior: 'smooth' });
          }
        });
      });

      // --- Live Shots Carousel ---
      function setupLiveCarousel() {
        const box = $('#liveCarousel'), dotsContainer = $('#liveDots');
        if (!box || !dotsContainer) return;
        
        box.innerHTML = ''; // Clear existing
        dotsContainer.innerHTML = '';
        
        const slides = [], bullets = [];
        let currentIndex = 0;

        liveImages.forEach((src, idx) => {
          const slide = document.createElement('div');
          slide.className = 'slide' + (idx === 0 ? ' active' : '');
          const img = new Image();
          img.alt = `Live shot ${idx + 1}`;
          img.decoding = 'async';
          img.loading = idx < 2 ? 'eager' : 'lazy';
          img.style.cssText = 'width:100%; height:100%; object-fit:cover;';
          img.src = src;
          slide.appendChild(img);
          box.appendChild(slide);
          slides.push(slide);

          const bullet = document.createElement('button');
          bullet.className = 'dot' + (idx === 0 ? ' active' : '');
          bullet.setAttribute('aria-label', `Go to slide ${idx + 1}`);
          bullet.addEventListener('click', () => goToSlide(idx));
          dotsContainer.appendChild(bullet);
          bullets.push(bullet);
        });
        box.appendChild(dotsContainer);

        function goToSlide(n) {
          if (n === currentIndex) return;
          slides[currentIndex].classList.remove('active');
          bullets[currentIndex].classList.remove('active');
          currentIndex = n;
          slides[currentIndex].classList.add('active');
          bullets[currentIndex].classList.add('active');
        }

        setInterval(() => {
          goToSlide((currentIndex + 1) % slides.length);
        }, 5000); // Auto-advance every 5 seconds
      }

      // --- Menu Rendering ---
      function renderMenu() {
        const wrap = $('#menuAccordions');
        if (!wrap) return;
        wrap.innerHTML = '';
        
        menuData.forEach(cat => {
          const details = document.createElement('details');
          details.className = 'menu-acc reveal';
          details.innerHTML = `
            <summary class="menu-sum">
              <span class="badge">${cat.badge}</span><h3>${cat.title}</h3>
              <svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>
            </summary>
            <div class="menu-body"></div>
          `;
          const body = details.querySelector('.menu-body');

          const renderItems = (items, container) => {
            items.forEach(it => {
              const photoBtn = it.photo ? `<button type="button" class="photo-btn" data-photo-src="${it.photo}" data-photo-caption="${it.name}"><svg viewBox="0 0 24 24" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg> Foto</button>` : '';
              container.innerHTML += `
                <div class="menu-item">
                  <div class="mi-left">${it.name} <span class="meta">${it.desc || ""}</span></div>
                  <div class="mi-right">
                    <div class="price">${it.price || ""}</div>
                    ${photoBtn}
                  </div>
                </div>`;
            });
          };

          if (cat.items) renderItems(cat.items, body);
          if (cat.groups) {
            cat.groups.forEach(gr => {
              body.innerHTML += `<div class="group-title">${gr.title}</div>`;
              renderItems(gr.items, body);
            });
          }
          wrap.appendChild(details);
        });
      }

      // --- Event Rendering ---
      let eventsExpanded = false;
      function renderEvents() {
        const list = $('#eventsList');
        if (!list) return;
        list.innerHTML = '';
        const sorted = [...events].sort((a, b) => new Date(a.dateISO) - new Date(b.dateISO));
        const toShow = eventsExpanded ? sorted : sorted.slice(0, 3);
        
        toShow.forEach(ev => {
          const d = new Date(ev.dateISO + 'T12:00:00');
          const day = String(d.getUTCDate()).padStart(2, '0');
          const mon = d.toLocaleString('it-IT', { month: 'short' }).toUpperCase();
          const dow = d.toLocaleString('it-IT', { weekday: 'short' }).toUpperCase();
          const eid = ev.dateISO + '::' + slug(ev.title);

          const cta = ev.booking === 'open' ? `<a class="pill pill--ghost" href="https://wa.me/393298252092?text=Vorrei%20prenotare%20per:%20${ev.title}" target="_blank" rel="noopener">Prenota</a>`
                      : `<span class="pill pill--ghost pill--disabled">${ev.booking === 'soon' ? 'Coming Soon' : 'Chiuso'}</span>`;

          const guestsHtml = (ev.guests || []).map(g => `<span class="name-chip">${g}</span>`).join('');

          const el = document.createElement('div');
          el.className = 'event reveal';
          el.dataset.eid = eid;
          el.innerHTML = `
            <div class="event__title"><strong>${ev.title}</strong></div>
            <div class="event__top">
              <div class="event__date">
                <div class="event__dow">${dow}</div><div class="event__day">${day} ${mon}</div>
              </div>
              ${cta}
            </div>
            <div class="event__info">${[ev.start ? `Start ${ev.start}` : null, ...(ev.genres || [])].filter(Boolean).map(t => `<span>${t}</span>`).join('')}</div>
            <div class="event__names">
              <span class="name-chip">${ev.headliner}</span>
              ${guestsHtml}
            </div>
            <div class="vote-badge"><svg class="icon" viewBox="0 0 24 24"><path d="M12 3l7 7h-4v11H9V10H5l7-7z" fill="currentColor"/></svg><strong class="n">0</strong></div>
            <div class="event__actions">
                <button class="pill pill--ghost share-btn"><svg class="icon" viewBox="0 0 24 24"><path d="M18 8a3 3 0 1 0-2.83-4h0A3 3 0 0 0 18 8ZM6 14a3 3 0 1 0-2.83 4h0A3 3 0 0 0 6 14ZM18 16a3 3 0 1 0 2.83 4h0A3 3 0 0 0 18 16Z" fill="currentColor"/><path d="M8.59 13.51l6.82-3.02M8.59 16.49l6.82 3.02" stroke="currentColor" stroke-width="2" fill="none"/></svg> Condividi</button>
            </div>
          `;
          list.appendChild(el);
        });
        updateEventCountsFromStore();
        
        const btn = $('#eventsMoreBtn');
        if (sorted.length <= 3) { btn.style.display = 'none'; } 
        else { btn.style.display = 'inline-flex'; btn.textContent = eventsExpanded ? 'Mostra meno' : 'Mostra altri'; }
      }
      
      $('#eventsMoreBtn')?.addEventListener('click', () => {
        eventsExpanded = !eventsExpanded;
        renderEvents();
      });

      // --- Interaction Store (Dummy for UI) ---
      const Store = {
        state: { myFlamesByEvent: {} },
        getMyFlame(eid) { return this.state.myFlamesByEvent[eid] || 0; },
        getFlameCount(eid) { return Math.floor(Math.random() * 50); /* Dummy count */ },
        toggleFlame({ eid }) {
          this.state.myFlamesByEvent[eid] = this.getMyFlame(eid) ? 0 : 1;
          return this.getMyFlame(eid);
        }
      };

      function updateEventCountsFromStore() {
        $$('#eventsList .event').forEach(el => {
            const eid = el.dataset.eid;
            if (!eid) return;
            const countEl = el.querySelector('.vote-badge .n');
            if (countEl) countEl.textContent = Store.getFlameCount(eid);
            el.classList.toggle('event--voted', !!Store.getMyFlame(eid));
        });
      }
      
      // --- Double Tap & Share Handlers ---
      document.addEventListener('click', e => {
        // Share button
        const shareBtn = e.target.closest('.share-btn');
        if (shareBtn) {
            const eventCard = shareBtn.closest('.event');
            const title = eventCard.querySelector('.event__title strong')?.textContent;
            const text = `Ci vediamo da 17/19 Urban Bistrot per l'evento "${title}"!`;
            if (navigator.share) {
                navigator.share({ title: `Evento da 17/19: ${title}`, text, url: window.location.href });
            } else {
                alert('La condivisione non è supportata su questo browser.');
            }
        }
      });
      
      let lastTap = 0;
      document.addEventListener('pointerdown', e => {
        const eventCard = e.target.closest('.event');
        if (!eventCard) return;
        
        const currentTime = new Date().getTime();
        const tapLength = currentTime - lastTap;
        if (tapLength < 300 && tapLength > 0) { // Double tap
            e.preventDefault();
            const eid = eventCard.dataset.eid;
            const myVote = Store.toggleFlame({ eid });
            eventCard.classList.toggle('event--voted', !!myVote);
            if(myVote) {
                eventCard.classList.remove('event--burst');
                void eventCard.offsetWidth; // Trigger reflow
                eventCard.classList.add('event--burst');
            }
        }
        lastTap = currentTime;
      });


      // --- Modal Logic ---
      const modal = $('#photoModal');
      const modalImg = $('#modalPhoto');
      const modalCaption = $('#modalCaption');
      let lastFocusedElement;

      function openModal(src, caption) {
        if (!modal || !modalImg || !modalCaption) return;
        lastFocusedElement = document.activeElement;
        modalImg.src = src;
        modalCaption.textContent = caption;
        modal.classList.add('show');
        modal.setAttribute('aria-hidden', 'false');
        document.body.classList.add('modal-open');
        $('.modal__close', modal).focus();
      }

      function closeModal() {
        if (!modal) return;
        modal.classList.remove('show');
        modal.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('modal-open');
        modalImg.src = ''; // Clear image to save memory
        if (lastFocusedElement) {
            lastFocusedElement.focus();
        }
      }

      document.addEventListener('click', e => {
        const photoBtn = e.target.closest('.photo-btn');
        if (photoBtn) {
          e.preventDefault();
          const src = photoBtn.dataset.photoSrc;
          const caption = photoBtn.dataset.photoCaption;
          if (src) openModal(src, caption);
        }
        
        if (e.target.closest('.modal__close')) closeModal();
        if (e.target === modal) closeModal(); // Click on overlay
      });
      
      window.addEventListener('keydown', e => {
        if (e.key === 'Escape' && modal.classList.contains('show')) closeModal();
      });

      // --- Intersection Observer for reveals ---
      const reveals = $$('.reveal');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(e => {
          if (e.isIntersecting) {
            e.target.classList.add('active');
            observer.unobserve(e.target);
          }
        });
      }, { threshold: 0.1 });
      reveals.forEach(el => observer.observe(el));

      /* ==========================================================================
         INITIALIZATION
         ========================================================================== */
      function init() {
        if (CONFIG.SHOW_POSTER) {
          $('#posterFrame').style.display = 'block';
          $('#liveCarousel').style.display = 'none';
        } else {
          $('#posterFrame').style.display = 'none';
          $('#liveCarousel').style.display = 'block';
          setupLiveCarousel();
        }
        renderMenu();
        renderEvents();
      }

      init();
    });
  </script>
</body>
</html>
