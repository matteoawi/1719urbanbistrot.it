<!DOCTYPE html>
<html lang="it" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>17/19 Urban Bistrot ‚Ä¢ Techno ‚Ä¢ Electro ‚Ä¢ House</title>
  <meta name="description" content="17/19 Urban Bistrot Roma. DJ set in vinile curated by Riccardo Battaglia. Colazioni, pranzi, cene e cocktail signature." />
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0b0b0b" media="(prefers-color-scheme: dark)">
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=Montserrat:wght@700;800;900&display=swap" rel="stylesheet"/>

  <style>
    /* ================= THEME TOKENS ================= */
    :root{
      --menu-blur: 18px;
      --menu-dim: 0.68;

      --bg:#ffffff; --fg:#0b0b0b; --muted:#6b7280; --line:#e5e7eb;
      --accent:#ff1f3d; --accent-fg:#ffffff;
      --chip:#f4f4f5; --chip-fg:#0b0b0b;
      --radius:16px; --pad:clamp(16px,4vw,32px); --max:1120px;

      /* === Reactions palette === */
      --fire:#ff6a00;
      --fire-2:#ff1f3d;
      --heart:#ff2b77;
      --rocket:#ff1f3d;
    }
    @media (prefers-color-scheme: dark){
      html[data-theme="auto"]{
        --bg:#0b0b0b; --fg:#ffffff; --muted:#9ca3af; --line:#1f1f1f;
        --accent:#ff1f3d; --accent-fg:#000000;
        --chip:#121212; --chip-fg:#e5e7eb;
      }
    }
    html[data-theme="light"]{
      --bg:#ffffff; --fg:#0b0b0b; --muted:#6b7280; --line:#e5e7eb;
      --accent:#ff1f3d; --accent-fg:#ffffff;
      --chip:#f4f4f5; --chip-fg:#0b0b0b;
    }
    html[data-theme="dark"]{
      --bg:#0b0b0b; --fg:#ffffff; --muted:#9ca3af; --line:#1f1f1f;
      --accent:#ff1f3d; --accent-fg:#000000;
      --chip:#121212; --chip-fg:#e5e7eb;
    }

    /* ================ BASE UI ================ */
    *{box-sizing:border-box}
    html,body{margin:0}
    body{background:var(--bg);color:var(--fg);font-family:'Inter',system-ui,sans-serif;line-height:1.6}
    img{max-width:100%;display:block}
    .container{max-width:var(--max);margin-inline:auto;padding-inline:var(--pad)}
    section{padding:20px 0}
    .grid{display:grid;gap:16px}
    .grid-2{grid-template-columns:1fr}
    .grid-3{grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}
    .only-desktop{display:none}
    .only-mobile{display:inline-flex}
    @media (min-width: 768px){
      .grid-2{grid-template-columns:1.2fr .8fr}
      .only-desktop{display:inline-flex}
      .only-mobile{display:none}
    }

    /* ===== Header ===== */
    header{position:fixed;top:0;left:0;right:0;background:transparent;border-bottom:0;z-index:100}
    header.header--solid{background:color-mix(in oklab, var(--bg) 85%, transparent);border-bottom:1px solid var(--line);backdrop-filter:saturate(140%) blur(8px)}
    nav{display:flex;align-items:center;justify-content:space-between;height:64px}
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
    .brand img{height:48px;width:auto}
    @media (min-width:768px){ .brand img{ height:56px } }
    .logo-dark{display:none}
    .logo-light{display:inline}
    html[data-theme="dark"] .logo-light{display:none}
    html[data-theme="dark"] .logo-dark{display:inline}
    html[data-theme="light"] .logo-light{display:inline}
    html[data-theme="light"] .logo-dark{display:none}
    @media (prefers-color-scheme: dark){
      html[data-theme="auto"] .logo-light{display:none}
      html[data-theme="auto"] .logo-dark{display:inline}
    }
    @media (prefers-color-scheme: light){
      html[data-theme="auto"] .logo-light{display:inline}
      html[data-theme="auto"] .logo-dark{display:none}
    }
    .nav-desktop{display:none;gap:18px;align-items:center;list-style:none;margin:0;padding:0}
    .nav-desktop a{color:var(--fg);text-decoration:none;font-weight:700;opacity:.82}
    .nav-desktop a:hover{opacity:1}
    @media (min-width:768px){ .nav-desktop{display:flex} }

    .pill{display:inline-flex;align-items:center;gap:.55rem;padding:.55rem .9rem;border:1px solid var(--line);border-radius:999px;text-decoration:none;font-weight:800;background:var(--chip);color:var(--chip-fg)}
    .pill--accent{background:var(--accent);border-color:var(--accent);color:var(--accent-fg)}
    .pill--ghost{background:transparent}
    .pill--disabled{opacity:.5;pointer-events:none}
    .pill:where(:hover,:focus-visible){transform:translateY(-1px);transition:transform .15s ease}

    .toggle{width:40px;height:40px;border:1px solid var(--line);border-radius:12px;background:var(--chip);color:var(--chip-fg);display:grid;place-items:center;cursor:pointer}
    .menu-toggle{width:44px;height:44px;border:1px solid var(--line);border-radius:12px;background:var(--chip);display:grid;place-items:center;cursor:pointer}
    .menu-toggle span,.menu-toggle span::before,.menu-toggle span::after{display:block;width:18px;height:2px;background:var(--fg);content:"";position:relative}
    .menu-toggle span::before{position:absolute;top:-6px}
    .menu-toggle span::after{position:absolute;top:6px}

    /* ===== Fullscreen Site Menu ===== */
    .sheet{
      position:fixed; inset:0;
      background:rgba(0,0,0,var(--menu-dim));
      opacity:0; pointer-events:none; z-index:999;
      transition:opacity .25s ease;
      backdrop-filter: blur(var(--menu-blur)) saturate(120%);
      -webkit-backdrop-filter: blur(var(--menu-blur)) saturate(120%);
      color:#fff;
    }
    .sheet.active{ opacity:1; pointer-events:auto; }
    .sheet__panel{ position:absolute; inset:0; display:grid; grid-template-rows:auto 1fr; align-items:start; }
    .sheet__close{
      position:absolute; top:14px; right:14px; width:44px; height:44px; border-radius:12px;
      border:1px solid rgba(255,255,255,.25);
      background:rgba(255,255,255,.10);
      color:#fff; font-size:24px; font-weight:900; display:grid; place-items:center; cursor:pointer;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      z-index:1000;
      touch-action:manipulation;
    }
    .sheet__inner{ display:grid; place-items:center; height:100%; padding:28px; opacity:.0; transform: translateY(6px) scale(.99); overflow: auto;}
    .sheet__list{list-style:none;margin:0;padding:0;display:grid;gap:14px;text-align:center}
    .sheet__list a{ display:block;padding:10px 14px;border-radius:14px;text-decoration:none;color:#fff;font-weight:900;font-size:clamp(1.4rem,5vw,2.4rem);letter-spacing:.04em; }
    .sheet__list a:hover{ background:rgba(255,255,255,.08); }
    .sheet__cta{display:inline-flex;margin-top:18px}

    .sheet.active .sheet__inner{ opacity:1; transform: translateY(0) scale(1); transition: opacity .25s ease .06s, transform .25s ease .06s; }
    .sheet.active .sheet__list a{ animation: menuStagger .28s ease both; }
    .sheet.active .sheet__list li:nth-child(1) a{ animation-delay:.05s }
    .sheet.active .sheet__list li:nth-child(2) a{ animation-delay:.09s }
    .sheet.active .sheet__list li:nth-child(3) a{ animation-delay:.13s }
    .sheet.active .sheet__list li:nth-child(4) a{ animation-delay:.17s }
    .sheet.active .sheet__list li:nth-child(5) a{ animation-delay:.21s }
    .sheet.active .sheet__list li:nth-child(6) a{ animation-delay:.25s }
    @keyframes menuStagger{ from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:translateY(0)} }

    body.menu-open{ overflow:hidden; }
    body.menu-open > :not(.sheet){ filter: blur(calc(var(--menu-blur) * .6)) saturate(1.06); transition: filter .25s ease; transform: translateZ(0); }

    /* ===== Hero ===== */
    .hero{padding:72px 0 24px}
    .tag{display:inline-flex;gap:8px;align-items:center;border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-weight:800;color:var(--muted);background:var(--chip)}
    h1{font-family:'Montserrat',system-ui,sans-serif;font-weight:900;text-transform:uppercase;letter-spacing:.01em;font-size:clamp(2.1rem,8vw,3.6rem);line-height:1.1;margin:12px 0 10px}
    .lead{color:var(--fg);font-size:clamp(1rem,4.5vw,1.18rem);margin:8px 0 14px}

    .hero-media{position:relative;border:1px solid var(--line);border-radius:16px;overflow:hidden;aspect-ratio:4/5;background:var(--chip);margin-top:14px}
    @media (min-width:768px){ .hero-media{aspect-ratio:16/9;margin-top:18px} }
    .slide{position:absolute;inset:0;opacity:0;transition:opacity .35s}
    .slide.active{opacity:1}
    .dots{position:absolute;left:0;right:0;bottom:8px;display:flex;gap:6px;justify-content:center}
    .dot{width:8px;height:8px;border-radius:999px;background:#a1a1aa;border:1px solid #00000020;cursor:pointer;opacity:.85}
    .dot.active{background:#fff;opacity:1}

    /* ===== Cards ===== */
    .card{border:1px solid var(--line);border-radius:16px;padding:16px;background:color-mix(in oklab, var(--bg) 96%, transparent)}
    .block-title{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    .block-title h3{font-family:'Montserrat',system-ui,sans-serif;font-size:1rem;margin:0;letter-spacing:.02em}
    .meta{color:var(--muted);font-size:.95rem}

    /* ===== Colonna destra hero: stack di card ===== */
    .hero-right{display:grid;gap:12px}

    /* ===== Mini time cards ===== */
    .time-cards{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:6px}
    .time-card{
      display:flex;align-items:center;justify-content:space-between;gap:10px;
      border:1px solid var(--line);border-radius:14px;padding:10px 12px;
      background:color-mix(in oklab, var(--bg) 98%, transparent)
    }
    .time-card .l{display:flex;align-items:center;gap:8px}
    .time-card .i{display:grid;place-items:center;width:28px;height:28px;border-radius:10px;background:var(--chip);border:1px solid var(--line)}

    /* ===== Menu (locale) ‚Äî Accordion ===== */
    .badge{display:inline-block;background:var(--accent);color:var(--accent-fg);padding:6px 10px;border-radius:999px;font-size:.75rem;font-weight:900}
    details.menu-acc{border:1px solid var(--line);border-radius:16px;background:color-mix(in oklab, var(--bg) 96%, transparent);padding:12px}
    details.menu-acc + details.menu-acc{margin-top:12px}
    details.menu-acc[open]{background:color-mix(in oklab, var(--bg) 98%, transparent)}
    summary.menu-sum{list-style:none;display:flex;align-items:center;gap:10px;cursor:pointer}
    summary.menu-sum::-webkit-details-marker{display:none}
    .menu-sum h3{margin:8px 0 0;font-family:'Montserrat',system-ui,sans-serif}
    .menu-sum .chev{margin-left:auto;transition:transform .2s}
    details[open] .menu-sum .chev{transform:rotate(180deg)}
    .menu-body{padding:8px 4px 2px}
    .group-title{margin:8px 0 4px;font-weight:800}
    .menu-item{display:flex;justify-content:space-between;gap:10px;padding:10px 0;border-bottom:1px dashed var(--line)}
    .menu-item:last-child{border-bottom:0}
    .price{color:var(--accent);font-weight:800}

    /* ===== Events ===== */
    .event{position:relative;display:grid;gap:10px;align-items:start;border:1px solid var(--line);border-radius:16px;padding:14px;background:color-mix(in oklab, var(--bg) 96%, transparent);transition:box-shadow .2s, transform .2s, border-color .2s}
    .event__title{font-weight:900}
    .event__top{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .event__date{min-width:66px;text-align:center;border:1px solid var(--line);border-radius:12px;padding:8px 10px;background:var(--chip)}
    .event__dow{font-weight:900}
    .event__day{font-size:1.4rem;font-weight:900;line-height:1}
    .event__info{display:flex;flex-wrap:wrap;gap:8px;color:var(--muted);font-size:.95rem}
    .event__names{display:flex;flex-wrap:wrap;gap:8px;margin-top:4px}
    .events-more{display:flex;justify-content:center;margin-top:10px}

    /* Flame state */
    .event--flamed{
      border-color: color-mix(in oklab, var(--fire) 70%, transparent);
      box-shadow: 0 0 0 1px color-mix(in oklab, var(--fire) 40%, transparent) inset,
                  0 6px 18px rgba(255,106,0,.25), 0 0 22px rgba(255,31,61,.15);
      animation: flamePulse 1.2s ease-in-out infinite alternate;
    }
    @keyframes flamePulse{
      from{ box-shadow: 0 0 0 1px rgba(255,106,0,.35) inset, 0 4px 14px rgba(255,106,0,.18), 0 0 16px rgba(255,31,61,.12) }
      to  { box-shadow: 0 0 0 1px rgba(255,31,61,.45) inset, 0 8px 22px rgba(255,31,61,.24), 0 0 24px rgba(255,106,0,.18) }
    }
    .flame-badge{
      position:absolute; top:8px; right:8px; font-weight:900;
      background:color-mix(in oklab, var(--bg) 92%, transparent);
      border:1px solid var(--line); border-radius:999px; padding:4px 8px; font-size:.9rem;
    }

    /* Name chips (headliner/guests) */
    .name-chip{
      display:inline-flex; align-items:center; gap:6px;
      padding:.18rem .46rem; border:1px dashed var(--line); border-radius:12px;
      font-weight:800; letter-spacing:.04em; cursor:pointer; user-select:none;
      background:color-mix(in oklab, var(--bg) 98%, transparent);
      transition:border-color .2s, transform .12s;
    }
    .name-chip:hover{ transform:translateY(-1px) }
    .name-chip .heart-count{
      display:inline-flex; align-items:center; gap:2px;
      font-size:.9rem; border:1px solid var(--line);
      background:color-mix(in oklab, var(--bg) 96%, transparent);
      padding:1px 6px; border-radius:999px;
    }
    .name-chip.hearted{
      border-color: color-mix(in oklab, var(--heart) 60%, var(--line));
      box-shadow:0 0 0 1px color-mix(in oklab, var(--heart) 40%, transparent) inset;
    }

    /* ===== Poster (hero) ===== */
    .poster-frame{position:relative;border:1px solid var(--line);border-radius:20px;background:var(--bg);overflow:hidden}
    .poster-inner{position:relative;padding:clamp(18px,4vw,28px)}
    .poster-head{display:flex;flex-direction:column;align-items:center;text-align:center;gap:6px}
    .poster-head .venue{font-weight:900;letter-spacing:.10em;text-transform:uppercase;font-size:clamp(.9rem,1.8vw,1rem)}
    .poster-head .series{font-family:'Montserrat',system-ui,sans-serif;font-weight:900;letter-spacing:.06em;text-transform:uppercase;font-size:clamp(2rem,6.5vw,3.1rem);line-height:1.05}
    .poster-head .date{font-weight:900;letter-spacing:.10em;text-transform:uppercase;font-size:clamp(.95rem,3.5vw,1.2rem)}
    .poster-head .tagline{margin-top:4px;font-weight:900;letter-spacing:.10em;text-transform:uppercase;color:var(--fg);font-size:clamp(.82rem,2.2vw,.96rem)}
    .poster-head .curated{color:var(--muted);font-weight:700;letter-spacing:.08em;text-transform:uppercase;font-size:clamp(.78rem,2vw,.9rem)}
    .poster-canvas{position:relative;margin-top:clamp(16px,3.2vw,26px);height:clamp(320px,56vw,480px);background:color-mix(in oklab, var(--chip) 94%, transparent);border:1px solid var(--line);border-radius:14px;overflow:hidden}
    .poster-svg{position:absolute;inset:0;color:var(--fg);z-index:0;opacity:.08}
    .bouncer{position:absolute;display:inline-block;padding:.16em .44em;border-radius:6px;font-weight:900;letter-spacing:.06em;text-transform:uppercase;white-space:nowrap;user-select:none;will-change:transform;box-shadow:0 0 0 1px var(--line) inset;background:color-mix(in oklab, var(--bg) 96%, transparent)}
    .bouncer .dot{display:inline-block;width:6px;height:6px;border-radius:2px;background:var(--fg);margin-right:8px;vertical-align:middle}
    .bouncer .mini-counter{position:absolute; top:-8px; right:-8px; font-size:.85rem; font-weight:900; background:color-mix(in oklab, var(--bg) 90%, transparent); border:1px solid var(--line); border-radius:999px; padding:2px 6px}
    .poster-logos{position:absolute;left:0;right:0;bottom:0;padding:10px;border-top:1px solid var(--line);display:flex;gap:12px;justify-content:center;align-items:center}

    /* === Rocket trail + shake === */
    .poster-canvas canvas.trail{ position:absolute; inset:0; pointer-events:none; z-index:1 }
    .bouncer{ z-index:2 }
    .bouncer.rocket{ box-shadow:0 0 0 1px var(--accent) inset, 0 0 16px rgba(255,31,61,.75) }
    .bouncer.rocket .dot{ background:var(--accent) }
    .poster-canvas.shake{ animation:canvasShake .45s ease both }
    @keyframes canvasShake{
      0%{ transform:translate(0,0) rotate(0) }
      20%{ transform:translate(-2px,2px) rotate(-.3deg) }
      40%{ transform:translate(2px,-2px) rotate(.3deg) }
      60%{ transform:translate(-2px,1px) rotate(-.2deg) }
      80%{ transform:translate(1px,-1px) rotate(.2deg) }
      100%{ transform:translate(0,0) rotate(0) }
    }

    /* ===== Gallery ===== */
    .gallery{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    @media (min-width:768px){ .gallery{grid-template-columns:repeat(4,1fr)} }
    .gallery a{position:relative;border:1px solid var(--line);border-radius:12px;overflow:hidden;background:var(--chip)}
    .credit{position:absolute;left:8px;bottom:8px;background:rgba(0,0,0,.55);color:#fff;padding:4px 6px;border-radius:8px;font-size:.75rem}

    /* ===== Map ===== */
    .map{border:1px solid var(--line);border-radius:16px;overflow:hidden}
    .map iframe{width:100%;height:320px;border:0}
    @media (min-width:768px){ .map iframe{height:360px} }

    /* ===== Footer + FAB ===== */
    footer{border-top:1px solid var(--line);padding:28px 0;color:var(--muted);text-align:center}
    .fab{position:fixed;right:16px;bottom:16px;width:56px;height:56px;border-radius:999px;background:var(--accent);display:grid;place-items:center;box-shadow:0 10px 22px rgba(0,0,0,.15);text-decoration:none;z-index:80}
    .fab svg{width:26px;height:26px}
    .fab path{fill:var(--accent-fg)}

    /* ===== Reveal ===== */
    .reveal{opacity:0;transform:translateY(16px);transition:opacity .5s ease, transform .5s ease}
    .reveal.active{opacity:1;transform:translateY(0)}

    /* === FIX MOBILE OVERFLOW === */
    html,body{max-width:100%; overflow-x:hidden;}
    .tag{ max-width:100%; white-space:normal; flex-wrap:wrap; overflow-wrap:anywhere; }
    .poster-logos{flex-wrap:wrap; row-gap:6px;}
    @media (max-width:420px){ .time-cards{grid-template-columns:1fr;} }

    /* ===== Community Counters (spostabile dove vuoi) ===== */
    #community{ padding-top:8px }
    .counters{ display:grid; grid-template-columns:1fr; gap:12px }
    @media (min-width:768px){ .counters{ grid-template-columns:1fr 1fr } }
    .counter-row{ display:flex; gap:10px; align-items:center; justify-content:space-between; font-weight:900 }
    .counter-row .big{ font-size:1.4rem }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container">
      <nav aria-label="principale">
        <a class="brand" href="#">
          <img class="logo-light" src="https://cdn.shopify.com/s/files/1/0887/8332/3459/files/1719logooo.svg?v=1755102480" alt="17/19 Urban Bistrot - Logo"/>
          <img class="logo-dark"  src="https://cdn.shopify.com/s/files/1/0887/8332/3459/files/1719logobianco.svg?v=1755104086" alt="17/19 Urban Bistrot - Logo (dark)"/>
        </a>

        <ul class="nav-desktop">
          <li><a href="#about">About</a></li>
          <li><a href="#menu">Menu</a></li>
          <li><a href="#music">Musica</a></li>
          <li><a href="#events">Eventi</a></li>
          <li><a href="#gallery">Gallery</a></li>
          <li><a href="#contact">Contatti</a></li>
          <li><a class="pill pill--accent" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot%2C%20vorrei%20prenotare" target="_blank" rel="noopener">Prenota</a></li>
          <li class="only-desktop"><button id="themeToggle" class="toggle" aria-label="Tema: automatico"></button></li>
          <li class="only-desktop"><button class="menu-toggle" id="menuToggleD" aria-label="Apri/chiudi menu"><span></span></button></li>
        </ul>

        <div class="only-mobile" style="gap:8px;align-items:center">
          <button id="themeToggleM" class="toggle" aria-label="Tema: automatico"></button>
          <button class="menu-toggle" id="menuToggle" aria-label="Apri/chiudi menu"><span></span></button>
        </div>
      </nav>
    </div>
  </header>

  <!-- Fullscreen Site Menu -->
  <div class="sheet" id="siteMenu" role="dialog" aria-hidden="true" aria-modal="true" aria-label="menu sito">
    <div class="sheet__panel">
      <button class="sheet__close" id="sheetClose" type="button" aria-label="Chiudi menu">√ó</button>
      <div class="sheet__inner">
        <ul class="sheet__list">
          <li><a href="#about">About</a></li>
          <li><a href="#menu">Menu</a></li>
          <li><a href="#music">Musica</a></li>
          <li><a href="#events">Eventi</a></li>
          <li><a href="#gallery">Gallery</a></li>
          <li><a href="#contact">Contatti</a></li>
        </ul>
        <a class="pill pill--accent sheet__cta" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot%2C%20vorrei%20prenotare" target="_blank" rel="noopener">Prenota</a>
      </div>
    </div>
  </div>

  <!-- Hero: Poster + Orari + About card -->
  <section class="hero">
    <div class="container grid grid-2">
      <!-- Colonna sinistra: poster -->
      <div class="reveal">
        <div class="poster-frame">
          <div class="poster-inner">
            <div class="poster-head">
              <div class="venue" id="posterVenue"></div>
              <div class="series" id="posterSeries"></div>
              <div class="date" id="posterDate"></div>
              <div class="tagline" id="posterTagline"></div>
              <div class="curated" id="posterCurated"></div>
            </div>
            <div class="poster-canvas" id="posterCanvas">
              <svg class="poster-svg" id="posterSvg" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
                <defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" stroke="currentColor" stroke-width="0.4" opacity="0.35"/></pattern></defs>
                <rect x="0" y="0" width="100" height="100" fill="url(#grid)"></rect>
              </svg>
            </div>
            <div class="poster-logos" id="posterLogos" aria-hidden="true"></div>
          </div>
        </div>
        <span class="tag" style="margin-top:12px">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="margin-right:6px">
            <path d="M12 22s7-5.33 7-12a7 7 0 1 0-14 0c0 6.67 7 12 7 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
          </svg>
          Roma ‚Ä¢ Via di Santa Costanza 17/19
        </span>
      </div>

      <!-- Colonna destra: orari + about -->
      <div class="hero-right">
        <aside class="card reveal" aria-label="Orari e Servizio">
          <div class="block-title"><h3>Orari & Apertura</h3><span class="meta">Servizio</span></div>
          <div class="time-cards">
            <div class="time-card">
              <div class="l">
                <span class="i" aria-hidden="true">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M17 8h1a4 4 0 0 1 0 8h-1"/><path d="M3 8h14v6a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><path d="M6 2v4M10 2v4M14 2v4"/>
                  </svg>
                </span>
                <strong>Colazioni</strong>
              </div>
              <strong>08:00‚Äì12:00</strong>
            </div>
            <div class="time-card">
              <div class="l">
                <span class="i" aria-hidden="true">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 3v7a2 2 0 0 0 2 2v9"/><path d="M8 3v7a2 2 0 0 1-2 2"/><path d="M12 3v18"/><path d="M15.5 3.5c2 2 2 6.5 0 8.5L12 12"/>
                  </svg>
                </span>
                <strong>Pranzo</strong>
              </div>
              <strong>12:00‚Äì15:00</strong>
            </div>
            <div class="time-card">
              <div class="l">
                <span class="i" aria-hidden="true">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 7a6 6 0 0 0-6 6h12a6 6 0 0 0-6-6Z"/><path d="M12 5v2"/><path d="M4 19h16"/>
                  </svg>
                </span>
                <strong>Cena</strong>
              </div>
              <strong>19:00‚Äì23:30</strong>
            </div>
            <div class="time-card">
              <div class="l">
                <span class="i" aria-hidden="true">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="2"/><path d="M14 10h.01"/><path d="M10 14h.01"/>
                  </svg>
                </span>
                <strong>DJ Set</strong>
              </div>
              <strong>22:00‚Äì02:00</strong>
            </div>
          </div>
        </aside>

        <div id="about" class="card reveal">
          <div class="block-title"><h3>Urban Bistrot</h3></div>
          <p style="margin:0">
            Specialty coffee, cucina contemporanea e serate <strong>vinyl only</strong>. Line-up a cura di <strong>Riccardo Battaglia</strong>.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Live Shots -->
  <section id="live">
    <div class="container">
      <div class="block-title" style="margin-bottom:14px"><h3>Live Shots</h3></div>
      <div class="hero-media" id="liveCarousel" aria-label="carosello">
        <div class="dots" id="liveDots"></div>
      </div>
    </div>
  </section>

  <!-- Menu -->
  <section id="menu">
    <div class="container">
      <div class="block-title" style="margin-bottom:6px"><h3>Il nostro men√π</h3></div>
      <div id="menuAccordions" class="grid" style="gap:12px"></div>
    </div>
  </section>

  <!-- MUSICA -->
  <section id="music">
    <div class="container grid grid-2">
      <div class="card reveal">
        <div class="block-title"><h3>Musica ‚Ä¢ Vinyl Only</h3></div>
        <p style="margin-top:6px">
          Vibe tra <strong>Roma</strong> e <strong>Berlino</strong>: groove ipnotici, minimal, acid ed electro. <strong>Solo vinile</strong>.
        </p>
        <ul style="margin:12px 0 0 18px;line-height:1.7">
          <li>Estetica raw, attitudine club</li>
          <li>Electro / techno / house essenziale</li>
          <li>Set estesi, warm-up & closing</li>
        </ul>
        <p class="meta" style="margin-top:10px">Manifesto: profondit√†, dinamica, eleganza.</p>
      </div>

      <div class="card reveal">
        <div class="block-title"><h3>Resident & Guests</h3></div>
        <p><strong>Resident</strong>: Riccardo Battaglia</p>
        <p><strong>Guests</strong>: selezione romano-berlinese, special set a sorpresa.</p>
        <div style="margin-top:10px;border-top:1px solid var(--line);padding-top:10px">
          <div class="block-title" style="margin:0"><h3>Impianto</h3><span class="meta">setup</span></div>
          <ul style="margin:8px 0 0 18px;line-height:1.7">
            <li>Giradischi e mixer pro</li>
            <li>Sound system ottimizzato</li>
            <li>Headroom controllata</li>
          </ul>
        </div>
        <p style="margin-top:12px">
          <a class="pill pill--ghost" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot%2C%20vorrei%20proporre%20un%20DJ%20set" target="_blank" rel="noopener">Booking / Proposte</a>
        </p>
      </div>
    </div>
  </section>

  <!-- Events -->
  <section id="events">
    <div class="container">
      <div class="block-title" style="margin-bottom:6px">
        <h3>Prossimi Eventi</h3>
      </div>
      <p class="meta" style="margin:-2px 0 12px">
        Interazione: <strong>doppio tap</strong> su un <em>nome</em> ‚áí üöÄ ‚Ä¢ su una <em>card evento</em> ‚áí üî• (toggle) ‚Ä¢ <strong>tap</strong> su Headliner/Guests ‚áí ‚ù§Ô∏è (toggle).
      </p>
      <div class="grid" id="eventsList" style="gap:12px"></div>
      <div class="events-more">
        <button id="eventsMoreBtn" class="pill pill--ghost" type="button">Mostra altri</button>
      </div>
    </div>
  </section>

  <!-- Gallery -->
  <section id="gallery">
    <div class="container">
      <div class="grid gallery" id="galleryGrid"></div>
      <p class="meta" style="margin-top:8px;text-align:center">Immagini da fonti pubbliche, citate con link all‚Äôoriginale.</p>
    </div>
  </section>

  <!-- Contact + Map -->
  <section id="contact">
    <div class="container grid grid-2">
      <div class="card reveal">
        <div class="block-title"><h3>Contatti</h3></div>
        <p><strong>Indirizzo</strong><br/>Via di Santa Costanza 17/19 ‚Äî 00198 Roma</p>
        <p><strong>Prenotazioni</strong><br/>
          WhatsApp: <a class="pill" href="https://wa.me/393298252092" target="_blank" rel="noopener">+39 329 825 2092</a><br/>
          Email: <a class="pill" href="mailto:info@1719bistrot.it">info@1719bistrot.it</a>
        </p>
        <p><strong>Social</strong><br/>
          <a class="pill" href="https://instagram.com/1719_cocktailbar" target="_blank" rel="noopener">Instagram</a>
          <a class="pill" href="https://www.facebook.com/p/1719-Cocktail-Bar-Bistrot-100077668764198/" target="_blank" rel="noopener">Facebook</a>
        </p>
      </div>

      <div class="card reveal">
        <div class="block-title">
          <h3>Dove siamo</h3>
          <a class="pill pill--accent" href="https://maps.app.goo.gl/DH48FCh9wvF6mF8p6" target="_blank" rel="noopener">Apri su Google Maps</a>
        </div>
        <div class="map">
          <iframe title="Mappa 17/19 Urban Bistrot" loading="lazy" referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps?q=41.9226318,12.5118941&z=16&output=embed"></iframe>
        </div>
      </div>
    </div>
  </section>

  <!-- Community Counters (spostabile) -->
  <section id="community">
    <div class="container">
      <div class="block-title" style="margin-bottom:8px"><h3>Community Counters</h3><span class="meta">reazioni live</span></div>
      <div class="counters">
        <!-- Card A: Rockets + Flames -->
        <div class="card">
          <div class="counter-row"><span>üöÄ Razzi (nomi)</span><span class="big" id="totalRockets">0</span></div>
          <div class="counter-row" style="margin-top:8px"><span>üî• Fiamme (eventi)</span><span class="big" id="totalFlames">0</span></div>
        </div>
        <!-- Card B: Hearts -->
        <div class="card">
          <div class="counter-row"><span>‚ù§Ô∏è Cuori (headliner/guests)</span><span class="big" id="totalHearts">0</span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <p>&copy; 2025 17/19 Urban Bistrot Roma</p>
    </div>
  </footer>

  <!-- WhatsApp FAB -->
  <a class="fab" href="https://wa.me/393298252092?text=Ciao%2017%2F19%20Urban%20Bistrot" target="_blank" rel="noopener" aria-label="WhatsApp">
    <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M12 1.5c5.8 0 10.5 4.7 10.5 10.5S17.8 22.5 12 22.5A10.5 10.5 0 0 1 6.99 21.23L3 21l.82-3.89A10.45 10.45 0 0 1 1.5 12C1.5 6.2 6.2 1.5 12 1.5Z" fill="currentColor" opacity=".96"/>
      <path d="M16.63 14.62c-.19-.1-1.13-.6-1.3-.66-.17-.06-.29-.1-.42.1s-.49.66-.6.8c-.11.13-.22.15-.41.06-.19-.1-.81-.3-1.55-.98-.57-.51-.95-1.13-1.06-1.31-.11-.19-.01-.29.09-.39.09-.09.2-.24.29-.36.1-.12.13-.2.19-.33.06-.13.03-.25-.02-.35-.05-.1-.44-1.05-.6-1.45-.16-.39-.33-.33-.45-.34h-.38c-.13 0-.33.05-.5.24-.17.19-.66.65-.66 1.59 0 .94.68 1.85.78 2 .1.13 1.31 2.07 3.2 2.91.45.2.8.32 1.04.41.44.15.85.13 1.17.08.36-.05 1.1-.45 1.25-.89.15-.44.15-.82.11-.91-.05-.08-.16-.13-.41-.25Z" fill="#fff"/>
    </svg>
  </a>

  <script>
    /* ========== Utils ========== */
    const $ = (s, r=document)=>r.querySelector(s);
    const $$ = (s, r=document)=>Array.from(r.querySelectorAll(s));
    const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));
    const slug = s=>String(s||'').toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'');

    /* ========== Scroll reveal ========== */
    const reveals = document.querySelectorAll('.reveal');
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e => { if(e.isIntersecting){ e.target.classList.add('active'); io.unobserve(e.target);} });
    },{ threshold:.14 });
    reveals.forEach(el=>io.observe(el));

    /* ========== Header translucido on scroll ========== */
    const header = document.querySelector('header');
    const onS = () => { header.classList.toggle('header--solid', window.scrollY > 8); };
    window.addEventListener('scroll', onS, {passive:true}); onS();

    /* ========== Fullscreen site menu ========== */
    const siteMenu = document.getElementById('siteMenu');
    const sheetClose = document.getElementById('sheetClose');
    const panel = siteMenu.querySelector('.sheet__panel');
    const inner = siteMenu.querySelector('.sheet__inner');
    const toggleBtns = [document.getElementById('menuToggle'), document.getElementById('menuToggleD')].filter(Boolean);

    const openMenu = ()=>{ siteMenu.classList.add('active'); siteMenu.setAttribute('aria-hidden','false'); document.body.classList.add('menu-open'); };
    const closeMenu = ()=>{ siteMenu.classList.remove('active'); siteMenu.setAttribute('aria-hidden','true'); document.body.classList.remove('menu-open'); };

    toggleBtns.forEach(btn=> btn.addEventListener('click', ()=> siteMenu.classList.contains('active') ? closeMenu() : openMenu()));
    sheetClose.addEventListener('click', (e)=>{ e.stopPropagation(); closeMenu(); });
    panel.addEventListener('click', (e)=>{ if(!inner.contains(e.target)) closeMenu(); });
    inner.addEventListener('click', (e)=> e.stopPropagation());
    window.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeMenu(); });
    siteMenu.querySelectorAll('a').forEach(a=> a.addEventListener('click', ()=> setTimeout(closeMenu,80)));

    /* ========== Link esterni fix ========== */
    (function(){
      document.querySelectorAll('a[href^="http"]').forEach(a=>{
        try{ const u=new URL(a.getAttribute('href'), location.href); if(u.origin!==location.origin){ a.setAttribute('target','_blank'); a.setAttribute('rel','noopener'); } }catch{}
      });
      document.addEventListener('click', function(e){
        const a = e.target.closest('a[href]'); if(!a) return;
        const href = a.getAttribute('href'); if(!href) return;
        if(href.startsWith('#') || href.startsWith('mailto:') || href.startsWith('tel:') || href.startsWith('javascript:')) return;
        let isExternal=false; try{ isExternal = (new URL(href, location.href).origin !== location.origin); }catch{}
        const openNewTab = isExternal || a.getAttribute('target')==='_blank';
        if(openNewTab){ e.preventDefault(); e.stopImmediatePropagation(); const win = window.open(href, '_blank'); if(!win){ location.href = href; } }
      }, true);
    })();

    /* ========== Theme toggle ========== */
    const THEME_KEY = 'theme-1719';
    const root = document.documentElement;
    function applyTheme(mode){ root.setAttribute('data-theme', mode); localStorage.setItem(THEME_KEY, mode); paintToggleIcon(mode); }
    function paintToggleIcon(mode){
      const svgAuto = `<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><circle cx="12" cy="12" r="5" fill="currentColor" opacity=".9"/><text x="12" y="22" text-anchor="middle" font-size="7" font-family="monospace" fill="currentColor" opacity=".9">AUTO</text></svg>`;
      const svgSun = `<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2m0 16v2M2 12h2m16 0h2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4"/></svg>`;
      const svgMoon = `<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>`;
      const icon = mode==='auto' ? svgAuto : mode==='light' ? svgSun : svgMoon;
      document.querySelectorAll('#themeToggle,#themeToggleM').forEach(btn=>btn.innerHTML = icon);
    }
    function cycleTheme(){ const cur = root.getAttribute('data-theme') || 'auto'; const next = cur==='auto' ? 'light' : cur==='light' ? 'dark' : 'auto'; applyTheme(next); }
    document.getElementById('themeToggle').addEventListener('click', cycleTheme);
    document.getElementById('themeToggleM').addEventListener('click', cycleTheme);
    applyTheme(localStorage.getItem(THEME_KEY) || 'auto');

    /* ========== Live Shots ========== */
    const liveImages = [
      'https://media-cdn.tripadvisor.com/media/photo-s/21/e8/71/95/19-il-nostro-stile-accogliente.jpg',
      'https://img3.restaurantguru.com/c493-Pub-and-bar-17-19-interior.jpg',
      'https://iorampo.com/wp-content/uploads/2024/12/17-19-800x600.jpg'
    ];
    (function(){
      const box  = document.getElementById('liveCarousel');
      const dots = document.getElementById('liveDots');
      if(!box) return;
      let i = 0; const slides=[], bullets=[];
      liveImages.forEach((src,idx)=>{
        const s = document.createElement('div'); s.className='slide'+(idx===0?' active':'');
        const im=new Image(); im.src=src; im.alt='Live '+(idx+1);
        Object.assign(im.style,{width:'100%',height:'100%',objectFit:'cover'}); im.loading='lazy';
        s.appendChild(im); box.appendChild(s); slides.push(s);
        const b=document.createElement('button'); b.className='dot'+(idx===0?' active':''); b.addEventListener('click',()=>go(idx)); dots.appendChild(b); bullets.push(b);
      });
      function go(n){ slides[i].classList.remove('active'); bullets[i]?.classList.remove('active'); i=n; slides[i].classList.add('active'); bullets[i]?.classList.add('active'); }
      setInterval(()=>{ if(slides.length>1) go((i+1)%slides.length); }, 5000);
    })();

    /* ===================== PERSISTENZA (local + opz. remoto) ===================== */
    const PERSIST_REMOTE = { enabled:false, endpoint:'' /* es: 'https://tuoworker.example.workers.dev/1719' */ };

    const Store = {
      key:'1719-reactions-v1',
      state:{ rocketsByName:{}, flamesByEvent:{}, heartsByEvent:{}, totals:{rockets:0, flames:0, hearts:0} },
      loaded:false,
      load(){
        try{ const s=localStorage.getItem(this.key); if(s){ const j=JSON.parse(s); this.state={...this.state, ...j}; } }catch{}
        this.loaded=true;
      },
      save(){
        try{ localStorage.setItem(this.key, JSON.stringify(this.state)); }catch{}
        this.remotePushDebounced();
      },
      incRocket(name){
        if(!name) return 0; const k = String(name).toUpperCase();
        this.state.rocketsByName[k] = (this.state.rocketsByName[k]||0) + 1;
        this.state.totals.rockets++;
        this.save(); return this.state.rocketsByName[k];
      },
      toggleFlame(eid){
        const curr = this.state.flamesByEvent[eid]||0;
        if(curr){ this.state.flamesByEvent[eid]=0; this.state.totals.flames = Math.max(0, this.state.totals.flames-1); }
        else { this.state.flamesByEvent[eid]=1; this.state.totals.flames++; }
        this.save(); return this.state.flamesByEvent[eid];
      },
      getFlame(eid){ return this.state.flamesByEvent[eid]||0; },
      toggleHeart(eid, name){
        const key = eid+'::'+String(name).toUpperCase();
        const curr = this.state.heartsByEvent[key]||0;
        const next = curr ? 0 : 1;
        this.state.heartsByEvent[key] = next;
        this.state.totals.hearts += next?1:-1;
        this.save(); return next;
      },
      getHeart(eid,name){ return this.state.heartsByEvent[eid+'::'+String(name).toUpperCase()]||0; },
      getRockets(name){ return this.state.rocketsByName[String(name).toUpperCase()]||0; },
      totals(){ return this.state.totals; },

      // ---- opzionale: sync remoto ----
      async remotePull(){
        if(!PERSIST_REMOTE.enabled || !PERSIST_REMOTE.endpoint) return;
        try{
          const r = await fetch(PERSIST_REMOTE.endpoint, {method:'GET'});
          if(!r.ok) return;
          const data = await r.json();
          // semplice merge: somma totali e unisci massimi
          const A = this.state, B = data||{};
          const merged = JSON.parse(JSON.stringify(A));
          // rockets
          for(const k in (B.rocketsByName||{})){
            merged.rocketsByName[k] = Math.max(A.rocketsByName[k]||0, B.rocketsByName[k]||0);
          }
          // flames
          for(const k in (B.flamesByEvent||{})){
            merged.flamesByEvent[k] = Math.max(A.flamesByEvent[k]||0, B.flamesByEvent[k]||0);
          }
          // hearts
          for(const k in (B.heartsByEvent||{})){
            merged.heartsByEvent[k] = Math.max(A.heartsByEvent[k]||0, B.heartsByEvent[k]||0);
          }
          // totals (ricalcolo da mappe)
          merged.totals = {
            rockets: Object.values(merged.rocketsByName).reduce((a,b)=>a+b,0),
            flames:  Object.values(merged.flamesByEvent).reduce((a,b)=>a+b,0),
            hearts:  Object.values(merged.heartsByEvent).reduce((a,b)=>a+b,0),
          };
          this.state = merged; this.save();
        }catch(e){ /* silenzio */ }
      },
      async remotePush(){
        if(!PERSIST_REMOTE.enabled || !PERSIST_REMOTE.endpoint) return;
        try{
          await fetch(PERSIST_REMOTE.endpoint, {
            method:'POST', headers:{'Content-Type':'application/json'},
            body: JSON.stringify(this.state)
          });
        }catch(e){ /* silenzio */ }
      },
      remotePushDebounced: (()=>{ let t; return function(){ clearTimeout(t); t=setTimeout(()=>this.remotePush(), 600); }; })()
    };
    Store.load();
    Store.remotePull(); // se abilitato

    /* ========== Helpers tap/double-tap ========== */
    function makeDoubleTap(el, handler, threshold=280){
      let last=0;
      el.addEventListener('dblclick', (e)=>{ e.preventDefault(); handler(e); });
      el.addEventListener('pointerdown', (e)=>{
        const now = performance.now();
        if(now - last < threshold){ handler(e); last=0; }
        else { last = now; }
      }, {passive:true});
    }

    /* ========== POSTER ========== */
    const posterData = {
      venue: '17/19 URBAN BISTROT',
      series: 'ELECTRO TECHNO NIGHT',
      date:   'WEDNESDAY 03/09',
      tagline:'TECHNO ‚Ä¢ ELECTRO ‚Ä¢ VINYL',
      curatedBy:'CURATED BY RICCARDO BATTAGLIA',
      logos:[ { text:'BIRRA PERONI' }, { text:'RAZZI' }, { text:'ANTI SANTA SANTA CLUB' }, { text:'ELETTRONICA' } ]
    };

    const posterCanvas = document.getElementById('posterCanvas');
    let bounceRAF = null, bouncers = [];
    let trailCanvas=null, trailCtx=null, trailRO=null;

    function setPosterTexts(p){
      const set = (id,txt)=>{ const el=document.getElementById(id); if(el) el.textContent=(txt||'').toUpperCase(); };
      set('posterVenue', p.venue);
      set('posterSeries',p.series);
      set('posterDate',  p.date);
      set('posterTagline', p.tagline);
      set('posterCurated', p.curatedBy);
      const logosWrap = document.getElementById('posterLogos'); logosWrap.innerHTML='';
      (p.logos||[]).forEach(L=>{
        if(L.src){ const img=new Image(); img.src=L.src; img.alt=L.alt||'logo'; img.style.maxHeight='14px'; img.style.opacity='.9'; logosWrap.appendChild(img); }
        else if(L.text){ const s=document.createElement('span'); s.textContent=L.text; s.style.fontWeight='900'; s.style.fontSize='.72rem'; s.style.letterSpacing='.12em'; logosWrap.appendChild(s); }
      });
    }

    function setupTrailCanvas(){
      if(trailCanvas) return;
      trailCanvas = document.createElement('canvas');
      trailCanvas.className = 'trail';
      posterCanvas.appendChild(trailCanvas);
      trailCtx = trailCanvas.getContext('2d');
      const resize = ()=> {
        const w = posterCanvas.clientWidth|0, h = posterCanvas.clientHeight|0;
        trailCanvas.width = w; trailCanvas.height = h;
        trailCtx.clearRect(0,0,w,h);
      };
      resize();
      if('ResizeObserver' in window){
        trailRO = new ResizeObserver(resize);
        trailRO.observe(posterCanvas);
      }else{
        window.addEventListener('resize', resize);
      }
    }

    function easeInOutCubic(t){ return t<.5 ? 4*t*t*t : 1 - Math.pow(-2*t+2,3)/2; }

    function clearBouncers(){
      cancelAnimationFrame(bounceRAF);
      bouncers.forEach(b=> b.el.remove());
      bouncers = [];
      if(trailCtx){ trailCtx.clearRect(0,0,trailCanvas.width,trailCanvas.height); }
    }

    function triggerRocket(targetEl){
      const b = bouncers.find(x=>x.el===targetEl); if(!b) return;
      const name = targetEl.dataset.name || '';
      const now = performance.now();
      const DUR = 1500, BOOST = 7.5;
      b.rocket = {start:now, end:now+DUR, max:BOOST};
      targetEl.classList.add('rocket');

      // counter üöÄ
      const n = Store.incRocket(name);
      const badge = targetEl.querySelector('.mini-counter');
      if(badge) badge.textContent = `üöÄ ${n}`;

      // piccolo surge sugli altri
      bouncers.forEach(o=>{
        if(o===b) return;
        o.surgeUntil = now + 550;
        o.surgeFactor = 1.4 + Math.random()*0.4;
      });

      // canvas shake
      posterCanvas.classList.remove('shake'); void posterCanvas.offsetWidth; posterCanvas.classList.add('shake');
      setTimeout(()=> targetEl.classList.remove('rocket'), DUR+80);
      renderTotals(); // aggiorna card totali
    }

    function initBouncers(names){
      clearBouncers(); setupTrailCanvas();
      const rect = posterCanvas.getBoundingClientRect();
      names.forEach((name, idx)=>{
        const el = document.createElement('div');
        el.className = 'bouncer';
        el.dataset.name = name.toUpperCase();
        el.innerHTML = `<span class="dot"></span>${name}<span class="mini-counter">üöÄ ${Store.getRockets(name)}</span>`;
        posterCanvas.appendChild(el);
        el.style.transform = 'translate(0,0)';

        const w = el.offsetWidth || 80;
        const h = el.offsetHeight || 28;
        const x = Math.random() * Math.max(1, rect.width - w);
        const y = Math.random() * Math.max(1, rect.height - h);
        const speed = 80 + (idx*12) + Math.random()*40;
        const angle = Math.random() * Math.PI * 2;
        const vx = Math.cos(angle) * speed;
        const vy = Math.sin(angle) * speed;

        const B = { el, x, y, w, h, vx, vy, rocket:null, surgeUntil:0, surgeFactor:1 };
        bouncers.push(B);

        // Interazioni: doppio click + doppio tap
        makeDoubleTap(el, ()=>triggerRocket(el));
      });

      let last = performance.now();
      const tick = (now)=>{
        const dt = (now - last) / 1000; last = now;
        const W = posterCanvas.clientWidth, H = posterCanvas.clientHeight;

        // fade-out lento trail
        if(trailCtx && (trailCanvas.width!==W || trailCanvas.height!==H)){ trailCanvas.width=W; trailCanvas.height=H; }
        if(trailCtx){
          trailCtx.save(); trailCtx.globalCompositeOperation = 'destination-out';
          trailCtx.fillStyle = 'rgba(0,0,0,0.08)'; trailCtx.fillRect(0,0,W,H); trailCtx.restore();
        }

        bouncers.forEach(b=>{
          let factor = 1;
          if(b.surgeUntil && now < b.surgeUntil) factor *= b.surgeFactor; else b.surgeUntil = 0;
          if(b.rocket && now < b.rocket.end){
            const t = (now - b.rocket.start) / (b.rocket.end - b.rocket.start);
            const e = easeInOutCubic(clamp(t,0,1)); factor *= (1 + e*(b.rocket.max - 1));
            if(trailCtx){
              const cx = b.x + b.w/2, cy = b.y + b.h/2;
              trailCtx.save();
              trailCtx.globalCompositeOperation = 'lighter';
              trailCtx.shadowColor = 'rgba(255,31,61,.7)'; trailCtx.shadowBlur = 18;
              trailCtx.fillStyle = 'rgba(255,31,61,.75)'; const r = 3 + 6*e;
              trailCtx.beginPath(); trailCtx.arc(cx, cy, r, 0, Math.PI*2); trailCtx.fill();
              trailCtx.restore();
            }
          }else if(b.rocket && now >= b.rocket.end){ b.rocket = null; }

          // fisica + rimbalzi
          let nx = b.x + b.vx * dt * factor;
          let ny = b.y + b.vy * dt * factor;
          if(nx <= 0){ nx = 0; b.vx *= -1; }
          if(ny <= 0){ ny = 0; b.vy *= -1; }
          if(nx + b.w >= W){ nx = W - b.w; b.vx *= -1; }
          if(ny + b.h >= H){ ny = H - b.h; b.vy *= -1; }

          b.x = nx; b.y = ny;
          b.el.style.transform = `translate(${nx}px, ${ny}px)`;
        });
        bounceRAF = requestAnimationFrame(tick);
      };
      bounceRAF = requestAnimationFrame(tick);
    }

    function formatPosterDate(iso){
      const d = new Date(iso + 'T12:00:00Z');
      const days = ['SUNDAY','MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY'];
      const dd = String(d.getUTCDate()).padStart(2,'0');
      const mm = String(d.getUTCMonth()+1).padStart(2,'0');
      return `${days[d.getUTCDay()]} ${dd}/${mm}`;
    }
    function toItDowShort(d){ return d.toLocaleString('it-IT',{weekday:'short'}).toUpperCase(); }
    function toMonShort(d){ return d.toLocaleString('it-IT',{month:'short'}).toUpperCase(); }
    function formatLongIt(iso){
      const d = new Date(iso + 'T12:00:00');
      return d.toLocaleDateString('it-IT', { weekday:'short', day:'numeric', month:'long', year:'numeric' });
    }
    function buildWaText(ev){
      const when = formatLongIt(ev.dateISO);
      const start = ev.start ? ` (start ${ev.start})` : '';
      return `Ciao 17/19 Urban Bistrot, vorrei prenotare un tavolo per "${ev.title}" di ${when}${start}. Nome: ____ ‚Ä¢ Persone: ____`;
    }
    function waUrlFromEvent(ev){ return `https://wa.me/393298252092?text=${encodeURIComponent(buildWaText(ev))}`; }

    function bindPosterFromEvent(ev){
      const names = [ev.headliner].concat(ev.guests||[]).filter(Boolean).map(s=>s.toUpperCase());
      posterData.venue    = (ev.venue||'17/19 URBAN BISTROT').toUpperCase();
      posterData.series   = (ev.title||'').toUpperCase();
      posterData.date     = formatPosterDate(ev.dateISO);
      posterData.tagline  = (ev.genres && ev.genres.length ? ev.genres.join(' ‚Ä¢ ') : 'TECHNO ‚Ä¢ ELECTRO ‚Ä¢ VINYL').toUpperCase();
      posterData.curatedBy= ('Curated by ' + (ev.curatedBy || 'Riccardo Battaglia')).toUpperCase();
      posterData.logos    = (ev.sponsors || []).map(s => s.src ? {src:s.src, alt:s.alt||'logo'} : {text:(s.text||'').toUpperCase()});
      setPosterTexts(posterData);
      initBouncers(names.slice(0,3));
    }

    /* ========== MENU DATA (EDITA QUI) ========== */
    const menuData = [
      { badge:'BREAKFAST', title:'Colazioni', items:[
        { name:'Cornetto Artigianale', desc:"crema / marmellata / vuoto", price:'‚Ç¨2' },
        { name:'Avocado Toast', desc:"uovo poch√©, lime", price:'‚Ç¨9' },
        { name:'Pancake Stack', desc:"acero, frutti rossi", price:'‚Ç¨8' },
        { name:'Yogurt Bowl', desc:"granola, miele, frutta", price:'‚Ç¨6' },
      ]},
      { badge:'LUNCH', title:'Pranzo', items:[
        { name:'Caesar Salad', desc:"pollo, crostini", price:'‚Ç¨12' },
        { name:'Club Sandwich', desc:"tacchino, bacon", price:'‚Ç¨13' },
        { name:'Pasta del Giorno', desc:"chiedi allo staff", price:'‚Ç¨14' },
        { name:'Tataki di Tonno', desc:"sesamo, agrumi", price:'‚Ç¨16' },
      ]},
      { badge:'DINNER', title:'Cena', items:[
        { name:'Polpo Grigliato', desc:"patate, olive", price:'‚Ç¨18' },
        { name:'Black Burger', desc:"cheddar, bacon", price:'‚Ç¨16' },
        { name:'Risotto Techno', desc:"nero di seppia", price:'‚Ç¨17' },
        { name:'Tagliata di Manzo', desc:"rucola, scaglie", price:'‚Ç¨20' },
      ]},
      { badge:'DRINKS', title:'Drinks', groups:[
        { title:'Cocktail Signature', items:[
          { name:'Neon Spritz', desc:"bitter, agrumi, metodo classico", price:'‚Ç¨10' },
          { name:'Vinyl Sour', desc:"whisky, albume, limone", price:'‚Ç¨11' },
          { name:'Acid Groove', desc:"gin, lime, basilico", price:'‚Ç¨10' },
          { name:'Electro Mule', desc:"vodka, ginger beer, lime", price:'‚Ç¨9' },
        ]},
        { title:'Vini al Calice', items:[
          { name:'Frascati Superiore DOC', desc:"bianco", price:'‚Ç¨6' },
          { name:'Cesanese del Piglio DOCG', desc:"rosso", price:'‚Ç¨7' },
          { name:'Ros√© Lazio', desc:"rosato", price:'‚Ç¨6' },
        ]},
        { title:'Birre', items:[
          { name:'Lager alla Spina', desc:"0.4L", price:'‚Ç¨6' },
          { name:'IPA Artigianale', desc:"bottiglia", price:'‚Ç¨7' },
        ]},
        { title:'Analcolici', items:[
          { name:'Virgin Mojito', desc:"lime, menta, soda", price:'‚Ç¨7' },
          { name:'Club Mate', desc:"bottiglia", price:'‚Ç¨4' },
        ]}
      ]}
    ];

    function renderMenu(){
      const wrap = document.getElementById('menuAccordions');
      wrap.innerHTML = '';
      menuData.forEach(cat=>{
        const details = document.createElement('details');
        details.className = 'menu-acc reveal';
        const sum = document.createElement('summary');
        sum.className = 'menu-sum';
        sum.innerHTML = `<span class="badge">${cat.badge}</span><h3>${cat.title}</h3><svg class="chev" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m6 9 6 6 6-6"/></svg>`;
        details.appendChild(sum);

        const body = document.createElement('div');
        body.className = 'menu-body';

        if(cat.items){
          cat.items.forEach(it=>{
            const row = document.createElement('div');
            row.className = 'menu-item';
            row.innerHTML = `<div>${it.name} <span class="meta">${it.desc||''}</span></div><div class="price">${it.price||''}</div>`;
            body.appendChild(row);
          });
        }
        if(cat.groups){
          cat.groups.forEach(gr=>{
            const gt = document.createElement('div');
            gt.className = 'group-title';
            gt.textContent = gr.title;
            body.appendChild(gt);
            gr.items.forEach(it=>{
              const row = document.createElement('div');
              row.className = 'menu-item';
              row.innerHTML = `<div>${it.name} <span class="meta">${it.desc||''}</span></div><div class="price">${it.price||''}</div>`;
              body.appendChild(row);
            });
          });
        }
        details.appendChild(body);
        wrap.appendChild(details);
      });
      document.querySelectorAll('.reveal:not(.active)').forEach(el=>io.observe(el));
    }

    /* ========== EVENTI ========== */
    const events = [
      {
        dateISO: '2025-09-03',
        comingSoon: false,
        venue: '17/19 URBAN BISTROT',
        title: 'Electro Techno ‚Ä¢ Vinyl Only',
        genres: ['TECHNO', 'ELECTRO', 'VINYL'],
        start: '22:30',
        curatedBy: 'Riccardo Battaglia',
        headliner: 'HEADLINER',
        guests: ['GUEST1', 'GUEST2'],
        sponsors: [ { text: 'SPONSOR1' }, { text: 'SPONSOR2' }, { text: 'ADJECTIVE1' }, { text: 'ADJECTIVE2' } ],
      },
      {
        dateISO: '2025-09-05',
        comingSoon: false,
        venue: '17/19 URBAN BISTROT',
        title: 'Acid District',
        genres: ['ACID', 'TECHNO', 'VINYL'],
        start: '22:30',
        curatedBy: 'Riccardo Battaglia',
        headliner: 'ALBA NERA',
        guests: ['RBN', 'GIO BERLIN'],
        sponsors: [ { text: 'CASAMIGOS' } ],
      },
      {
        dateISO: '2025-09-07',
        comingSoon: false,
        venue: '17/19 URBAN BISTROT',
        title: 'Minimal Sunday',
        genres: ['MINIMAL', 'DEEP', 'VINYL'],
        start: '18:00',
        curatedBy: 'Riccardo Battaglia',
        headliner: 'MARCO VOSS',
        guests: ['LIVIA FERRO'],
        sponsors: [ { text: 'ORGANICS' } ],
      },
      { dateISO: '2025-09-12', comingSoon: true,  venue: '17/19 URBAN BISTROT', title: 'Friday Deep Cuts', genres: ['DEEP', 'MINIMAL', 'VINYL'], start: '22:30', curatedBy: 'Riccardo Battaglia', headliner: 'TBA', guests: [] },
      { dateISO: '2025-09-14', comingSoon: true,  venue: '17/19 URBAN BISTROT', title: 'Sunday Grooves',   genres: ['HOUSE', 'MINIMAL'], start: '18:00', curatedBy: 'Riccardo Battaglia', headliner: 'TBA' },
      { dateISO: '2025-09-20', comingSoon: true,  venue: '17/19 URBAN BISTROT', title: 'Electro Romance',  genres: ['ELECTRO', 'TECHNO'], start: '22:30', curatedBy: 'Riccardo Battaglia', headliner: 'VALE C.', guests: ['M.A.D.'] },
      { dateISO: '2025-09-27', comingSoon: true,  venue: '17/19 URBAN BISTROT', title: 'Vinyl Marathon',   genres: ['TECHNO', 'HOUSE'], start: '22:00', curatedBy: 'Riccardo Battaglia', headliner: 'TBA' }
    ];

    function pickNextEvent(){
      const today = new Date(); today.setHours(0,0,0,0);
      const up = events.filter(e=>!isNaN(new Date(e.dateISO)) && new Date(e.dateISO) >= today)
                       .sort((a,b)=> new Date(a.dateISO)-new Date(b.dateISO));
      return up[0] || events.sort((a,b)=> new Date(a.dateISO)-new Date(b.dateISO))[0];
    }

    function eventId(ev){ return ev.dateISO + '::' + slug(ev.title); }

    function makeNameChip(name, role, evID){
      if(!name) return null;
      const chip = document.createElement('span');
      chip.className = 'name-chip';
      chip.dataset.name = name;
      chip.dataset.event = evID;
      const count = Store.getHeart(evID, name);
      chip.innerHTML = `${role==='headliner' ? '<span class="dot" style="width:8px;height:8px;border-radius:3px;background:var(--fg);margin-right:6px"></span>' : ''}${name} <span class="heart-count">‚ù§Ô∏è ${count}</span>`;
      if(count) chip.classList.add('hearted');
      chip.addEventListener('click', ()=>{
        const on = Store.toggleHeart(evID, name);
        const hc = chip.querySelector('.heart-count');
        hc.textContent = `‚ù§Ô∏è ${on?1:0}`;
        chip.classList.toggle('hearted', !!on);
        renderTotals();
      });
      return chip;
    }

    let eventsExpanded = false;
    function renderEvents(){
      const list = document.getElementById('eventsList'); if(!list) return;
      list.innerHTML='';
      const sorted = [...events].sort((a,b)=> new Date(a.dateISO)-new Date(b.dateISO)).slice(0,7);
      const toShow = eventsExpanded ? sorted : sorted.slice(0,3);
      toShow.forEach(ev=>{
        const d = new Date(ev.dateISO + 'T12:00:00');
        const day = String(d.getUTCDate()).padStart(2,'0');
        const mon = toMonShort(d);
        const dow = toItDowShort(d).slice(0,3).toUpperCase();
        const eid = eventId(ev);

        const el = document.createElement('div'); el.className='event';
        el.dataset.eid = eid;

        // Title
        const title = document.createElement('div');
        title.className = 'event__title';
        title.innerHTML = `<strong>${ev.title}</strong>`;
        el.appendChild(title);

        // Top bar
        const top = document.createElement('div');
        top.className = 'event__top';

        const dateBox = document.createElement('div');
        dateBox.className = 'event__date';
        dateBox.innerHTML = `<div class="event__dow">${dow}</div><div class="event__day">${day} ${mon}</div>`;
        top.appendChild(dateBox);

        let cta;
        if(ev.comingSoon){
          cta = document.createElement('span');
          cta.className = 'pill pill--ghost pill--disabled event__cta';
          cta.textContent = 'Coming Soon';
        }else{
          cta = document.createElement('a');
          cta.className = 'pill pill--ghost event__cta';
          cta.href = waUrlFromEvent(ev);
          cta.target = '_blank'; cta.rel = 'noopener';
          cta.textContent = 'Prenota';
        }
        top.appendChild(cta);
        el.appendChild(top);

        // Info row
        const info = document.createElement('div');
        info.className = 'event__info';
        if(ev.comingSoon){
          info.innerHTML = `<span>COMING SOON</span>`;
        }else{
          const guestsTxt = ev.guests && ev.guests.length ? `Guests: ${ev.guests.join(', ')}` : null;
          const parts = [ ev.start ? `Start ${ev.start}` : null, ...(ev.genres||[]), guestsTxt ].filter(Boolean);
          info.innerHTML = parts.map(t=>`<span>${t}</span>`).join('');
        }
        el.appendChild(info);

        // Names row (headliner + guest chips)
        const namesRow = document.createElement('div');
        namesRow.className = 'event__names';
        const head = makeNameChip(ev.headliner, 'headliner', eid); if(head) namesRow.appendChild(head);
        (ev.guests||[]).forEach(g=>{ const ch = makeNameChip(g, 'guest', eid); if(ch) namesRow.appendChild(ch); });
        el.appendChild(namesRow);

        // Flame badge
        const fb = document.createElement('div'); fb.className = 'flame-badge'; fb.textContent = `üî• ${Store.getFlame(eid)}`;
        el.appendChild(fb);

        // apply current flame state
        if(Store.getFlame(eid)) el.classList.add('event--flamed');

        // Double-tap on card => toggle flame
        makeDoubleTap(el, ()=>{
          const on = Store.toggleFlame(eid);
          el.classList.toggle('event--flamed', !!on);
          fb.textContent = `üî• ${on}`;
          // piccola anim
          el.style.transform='scale(1.02)'; setTimeout(()=>el.style.transform='', 120);
          renderTotals();
        });

        list.appendChild(el);
      });

      const btn = document.getElementById('eventsMoreBtn');
      if(sorted.length <= 3){ btn.style.display = 'none'; }
      else { btn.style.display = 'inline-flex'; btn.textContent = eventsExpanded ? 'Mostra meno' : 'Mostra altri'; }
    }

    /* ===== REACTIONS TOTALS RENDER ===== */
    function renderTotals(){
      const t = Store.totals();
      $('#totalRockets').textContent = t.rockets || 0;
      $('#totalFlames').textContent  = t.flames  || 0;
      $('#totalHearts').textContent  = t.hearts  || 0;
    }

    // Init
    function initAll(){
      renderMenu();
      renderEvents();
      bindPosterFromEvent(pickNextEvent());
      $('#eventsMoreBtn').addEventListener('click', ()=>{ eventsExpanded = !eventsExpanded; renderEvents(); });
      renderTotals();
    }
    initAll();

    /* ========== Gallery (con crediti) ========== */
    const galleryData = [
      { src:'https://img3.restaurantguru.com/c493-Pub-and-bar-17-19-interior.jpg', alt:'Interni 17/19', credit:'Restaurant Guru', href:'https://restaurantguru.it/1719-LIve-Eat-Drink-Love-Rome' },
      { src:'https://img.restaurantguru.com/ccd7-17-19-Stenfields-and-c-Rome-dishes.jpg', alt:'Piatti 17/19', credit:'Restaurant Guru', href:'https://restaurantguru.it/1719-LIve-Eat-Drink-Love-Rome' },
      { src:'https://img3.restaurantguru.com/c467-Pub-and-bar-17-19-Stenfields-and-c-exterior.jpg', alt:'Esterni 17/19', credit:'Restaurant Guru', href:'https://restaurantguru.it/1719-LIve-Eat-Drink-Love-Rome' },
      { src:'https://iorampo.com/wp-content/uploads/2024/12/17-19-800x600.jpg', alt:'Bar 17/19', credit:'IoRampo', href:'https://iorampo.com' }
    ];
    const galleryGrid = document.getElementById('galleryGrid');
    galleryData.forEach(g=>{
      const a=document.createElement('a'); a.href=g.href; a.target='_blank'; a.rel='noopener';
      a.innerHTML = `<img loading="lazy" decoding="async" src="${g.src}" alt="${g.alt}"><span class="credit">¬© ${g.credit}</span>`;
      galleryGrid.appendChild(a);
    });
  </script>
</body>
</html>
